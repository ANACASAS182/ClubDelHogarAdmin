"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1824],{1824:(Mt,A,p)=>{p.r(A),p.d(A,{ProductosPageModule:()=>jt});var b=p(2881),v=p(9417),c=p(3092),B=p(9870),E=p(467),D=p(7550),M=p(2042),P=p(3662),X=p(1413),k=p(4843),q=p(152),H=p(3294),Q=p(6977),O=p(7786),Y=p(9172),N=p(5558),j=p(9437),R=p(7673),y=p(6354),x=p(6231),o=p(1360),I=p(7643),W=p(5312);let V=(()=>{var e;class a{constructor(t){this.http=t,this.apiUrl=W.c.apiUrl+"api/Producto"}getProductoById(t){return this.http.get(`${this.apiUrl}/getProductoById`,{params:(new I.Nl).set("productoId",String(t))})}getAllProductosEmpresa(t){const n=(new I.Nl).set("empresaID",String(t));return this.http.get(`${this.apiUrl}/GetProductosEmpresa`,{params:n}).pipe((0,y.T)(l=>{var r;return null!==(r=null==l?void 0:l.data)&&void 0!==r?r:[]}),(0,j.W)(()=>(0,R.of)([])))}getProductoAllPaginated(t){var n,l,r,s,d,u;const m=(new I.Nl).set("page",String(t.page)).set("size",String(t.size)).set("sortBy",null!==(n=t.sortBy)&&void 0!==n?n:"").set("sortDir",null!==(l=t.sortDir)&&void 0!==l?l:"").set("searchQuery",null!==(r=t.searchQuery)&&void 0!==r?r:"").set("grupoID",String(null!==(s=t.grupoID)&&void 0!==s?s:0)).set("empresaID",String(null!==(d=t.empresaID)&&void 0!==d?d:0)).set("vigenciaFilter",String(null!==(u=t.vigenciaFilter)&&void 0!==u?u:0));return this.http.get(`${this.apiUrl}/GetAllProductoPaginated`,{params:m})}getProductoByEmpresaPaginated(t){var n,l,r,s;const d=(new I.Nl).set("empresaID",String(t.empresaID)).set("page",String(t.page)).set("size",String(t.size)).set("sortBy",null!==(n=t.sortBy)&&void 0!==n?n:"").set("sortDir",null!==(l=t.sortDir)&&void 0!==l?l:"").set("searchQuery",null!==(r=t.searchQuery)&&void 0!==r?r:"").set("vigenciaFilter",String(null!==(s=t.vigenciaFilter)&&void 0!==s?s:0));return this.http.get(`${this.apiUrl}/GetProductoByEmpresaPaginated`,{params:d}).pipe((0,y.T)(u=>{var m,g,f,F,C;const h=null!==(m=null==u?void 0:u.data)&&void 0!==m?m:{},_=null!==(g=null!==(f=h.items)&&void 0!==f?f:h.Items)&&void 0!==g?g:[];return{items:_,total:null!==(F=null!==(C=h.total)&&void 0!==C?C:h.Total)&&void 0!==F?F:Array.isArray(_)?_.length:0}}),(0,j.W)(()=>(0,R.of)({items:[],total:0})))}save(t){return this.http.post(`${this.apiUrl}/Save`,t)}}return(e=a).\u0275fac=function(t){return new(t||e)(o.KVO(I.Qq))},e.\u0275prov=o.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),a})();var w=p(7248);function Z(e,a){if(1&e){const i=o.RV6();o.j41(0,"ion-item",26)(1,"ion-label"),o.EFF(2),o.k0s(),o.j41(3,"ion-toggle",27),o.bIt("ionChange",function(n){o.eBV(i);const l=o.XpG(3);return o.Njj(l.onToggleChange(n))}),o.k0s()()}if(2&e){const i=o.XpG(3);o.R7$(2),o.JRh(i.isReadOnly?"Ver":"Editar"),o.R7$(),o.Y8G("checked",!i.isReadOnly)}}function K(e,a){if(1&e&&(o.j41(0,"div",21)(1,"ion-chip",22),o.nrm(2,"ion-icon",23),o.j41(3,"ion-label"),o.EFF(4),o.k0s()(),o.nrm(5,"div",24),o.DNE(6,Z,4,2,"ion-item",25),o.k0s()),2&e){const i=o.XpG(2);o.R7$(),o.Y8G("color",i.isReadOnly?"medium":"warning"),o.R7$(),o.Y8G("name",i.isReadOnly?"eye-outline":"create-outline"),o.R7$(2),o.JRh(i.isReadOnly?"Modo lectura":"Modo edici\xf3n"),o.R7$(2),o.Y8G("ngIf",!i.isSocio)}}function oo(e,a){1&e&&(o.j41(0,"ion-note",28),o.nrm(1,"ion-icon",29),o.EFF(2," Activa "),o.j41(3,"strong"),o.EFF(4,"\u201cEditar\u201d"),o.k0s(),o.EFF(5," para modificar el nombre, la descripci\xf3n, los precios y la vigencia. "),o.k0s())}function to(e,a){1&e&&(o.j41(0,"ion-note",28),o.nrm(1,"ion-icon",30),o.EFF(2," Est\xe1s viendo la informaci\xf3n del producto. Si necesitas cambios, contacta a un administrador. "),o.k0s())}function eo(e,a){if(1&e){const i=o.RV6();o.j41(0,"ion-note",31),o.EFF(1," Est\xe1s en "),o.j41(2,"strong"),o.EFF(3,"modo edici\xf3n"),o.k0s(),o.EFF(4,". Recuerda "),o.j41(5,"strong"),o.EFF(6,"Guardar cambios"),o.k0s(),o.EFF(7," o "),o.j41(8,"button",32),o.bIt("click",function(){o.eBV(i);const n=o.XpG(2);return o.Njj(n.reset())}),o.EFF(9,"Descartar"),o.k0s(),o.EFF(10,". "),o.k0s()}}function no(e,a){if(1&e&&(o.j41(0,"h2",33),o.EFF(1),o.k0s()),2&e){const i=o.XpG(2);o.R7$(),o.JRh(i.form.value.nombre)}}function io(e,a){1&e&&(o.j41(0,"ion-item",34)(1,"ion-label",35),o.EFF(2,"Nombre del producto"),o.k0s(),o.nrm(3,"ion-input",36),o.k0s())}function lo(e,a){if(1&e&&(o.j41(0,"p",37),o.EFF(1),o.k0s()),2&e){const i=o.XpG(2);o.R7$(),o.JRh(i.form.value.descripcion)}}function ro(e,a){1&e&&(o.j41(0,"ion-item",34)(1,"ion-label",35),o.EFF(2,"Descripci\xf3n"),o.k0s(),o.nrm(3,"ion-textarea",38),o.k0s())}function ao(e,a){if(1&e&&(o.j41(0,"p",11)(1,"strong"),o.EFF(2,"Vigencia:"),o.k0s(),o.EFF(3),o.k0s()),2&e){const i=o.XpG(2);o.R7$(3),o.SpI(" ",i.form.value.vigenciaLetra||"No aplica"," ")}}function so(e,a){if(1&e&&o.nrm(0,"ion-datetime",44),2&e){const i=o.XpG(3);o.Y8G("preferWheel",!1)("min",i.minVigencia)("max",i.maxVigencia)("showDefaultButtons",!0)}}function co(e,a){1&e&&(o.j41(0,"div",39)(1,"ion-label",40),o.EFF(2,"Vigencia"),o.k0s(),o.j41(3,"div",41),o.nrm(4,"ion-datetime-button",42),o.k0s(),o.j41(5,"ion-modal",43),o.DNE(6,so,1,4,"ng-template"),o.k0s()()),2&e&&(o.R7$(5),o.Y8G("keepContentsMounted",!0))}function uo(e,a){if(1&e&&(o.j41(0,"div",48),o.EFF(1),o.k0s()),2&e){const i=o.XpG(3);o.R7$(),o.JRh(i.formatMonto(i.form.value.nivel1))}}function mo(e,a){if(1&e&&(o.j41(0,"div",49),o.nrm(1,"ion-input",50),o.j41(2,"ion-note",51),o.EFF(3),o.k0s()()),2&e){const i=o.XpG(3);o.R7$(3),o.JRh(i.unidad)}}function po(e,a){if(1&e&&(o.j41(0,"div",48),o.EFF(1),o.k0s()),2&e){const i=o.XpG(3);o.R7$(),o.JRh(i.formatMonto(i.form.value.nivel2))}}function _o(e,a){if(1&e&&(o.j41(0,"div",49),o.nrm(1,"ion-input",52),o.j41(2,"ion-note",51),o.EFF(3),o.k0s()()),2&e){const i=o.XpG(3);o.R7$(3),o.JRh(i.unidad)}}function go(e,a){if(1&e&&(o.j41(0,"div",48),o.EFF(1),o.k0s()),2&e){const i=o.XpG(3);o.R7$(),o.JRh(i.formatMonto(i.form.value.nivel3))}}function vo(e,a){if(1&e&&(o.j41(0,"div",49),o.nrm(1,"ion-input",53),o.j41(2,"ion-note",51),o.EFF(3),o.k0s()()),2&e){const i=o.XpG(3);o.R7$(3),o.JRh(i.unidad)}}function fo(e,a){if(1&e&&(o.j41(0,"div",48),o.EFF(1),o.k0s()),2&e){const i=o.XpG(3);o.R7$(),o.JRh(i.formatMonto(i.form.value.nivel4))}}function ho(e,a){if(1&e&&(o.j41(0,"div",49),o.nrm(1,"ion-input",54),o.j41(2,"ion-note",51),o.EFF(3),o.k0s()()),2&e){const i=o.XpG(3);o.R7$(3),o.JRh(i.unidad)}}function Co(e,a){if(1&e&&(o.j41(0,"div",48),o.EFF(1),o.k0s()),2&e){const i=o.XpG(3);o.R7$(),o.JRh(i.formatMonto(i.form.value.nivelInvitacion))}}function Fo(e,a){if(1&e&&(o.j41(0,"div",49),o.nrm(1,"ion-input",55),o.j41(2,"ion-note",51),o.EFF(3),o.k0s()()),2&e){const i=o.XpG(3);o.R7$(3),o.JRh(i.unidad)}}function Po(e,a){if(1&e&&(o.j41(0,"div",48),o.EFF(1),o.k0s()),2&e){const i=o.XpG(3);o.R7$(),o.JRh(i.formatMonto(i.form.value.nivelMaster))}}function bo(e,a){if(1&e&&(o.j41(0,"div",49),o.nrm(1,"ion-input",56),o.j41(2,"ion-note",51),o.EFF(3),o.k0s()()),2&e){const i=o.XpG(3);o.R7$(3),o.JRh(i.unidad)}}function xo(e,a){if(1&e&&(o.j41(0,"ion-list",45)(1,"ion-item")(2,"ion-label"),o.EFF(3,"Nivel 1"),o.k0s(),o.DNE(4,uo,2,1,"div",46)(5,mo,4,1,"div",47),o.k0s(),o.j41(6,"ion-item")(7,"ion-label"),o.EFF(8,"Nivel 2"),o.k0s(),o.DNE(9,po,2,1,"div",46)(10,_o,4,1,"div",47),o.k0s(),o.j41(11,"ion-item")(12,"ion-label"),o.EFF(13,"Nivel 3"),o.k0s(),o.DNE(14,go,2,1,"div",46)(15,vo,4,1,"div",47),o.k0s(),o.j41(16,"ion-item")(17,"ion-label"),o.EFF(18,"Nivel 4"),o.k0s(),o.DNE(19,fo,2,1,"div",46)(20,ho,4,1,"div",47),o.k0s(),o.j41(21,"ion-item")(22,"ion-label"),o.EFF(23,"Invitaci\xf3n"),o.k0s(),o.DNE(24,Co,2,1,"div",46)(25,Fo,4,1,"div",47),o.k0s(),o.j41(26,"ion-item")(27,"ion-label"),o.EFF(28,"Master"),o.k0s(),o.DNE(29,Po,2,1,"div",46)(30,bo,4,1,"div",47),o.k0s()()),2&e){const i=o.XpG(2);o.R7$(4),o.Y8G("ngIf",i.isReadOnly),o.R7$(),o.Y8G("ngIf",!i.isReadOnly),o.R7$(4),o.Y8G("ngIf",i.isReadOnly),o.R7$(),o.Y8G("ngIf",!i.isReadOnly),o.R7$(4),o.Y8G("ngIf",i.isReadOnly),o.R7$(),o.Y8G("ngIf",!i.isReadOnly),o.R7$(4),o.Y8G("ngIf",i.isReadOnly),o.R7$(),o.Y8G("ngIf",!i.isReadOnly),o.R7$(4),o.Y8G("ngIf",i.isReadOnly),o.R7$(),o.Y8G("ngIf",!i.isReadOnly),o.R7$(4),o.Y8G("ngIf",i.isReadOnly),o.R7$(),o.Y8G("ngIf",!i.isReadOnly)}}function Eo(e,a){if(1&e){const i=o.RV6();o.j41(0,"div",57)(1,"ion-button",58),o.bIt("click",function(){o.eBV(i);const n=o.XpG(2);return o.Njj(n.reset())}),o.EFF(2,"Descartar"),o.k0s(),o.nrm(3,"div",24),o.j41(4,"ion-button",59),o.bIt("click",function(){o.eBV(i);const n=o.XpG(2);return o.Njj(n.guardar())}),o.EFF(5),o.k0s()()}if(2&e){const i=o.XpG(2);o.R7$(4),o.Y8G("disabled",i.saving||i.form.pristine||i.form.invalid),o.R7$(),o.SpI(" ",i.saving?"Guardando\u2026":"Guardar cambios"," ")}}function ko(e,a){if(1&e&&(o.j41(0,"form",1),o.DNE(1,K,7,4,"div",2)(2,oo,6,0,"ion-note",3)(3,to,3,0,"ion-note",3)(4,eo,11,0,"ion-note",4),o.j41(5,"div",5)(6,"div",6),o.DNE(7,no,2,1,"h2",7)(8,io,4,0,"ion-item",8)(9,lo,2,1,"p",9)(10,ro,4,0,"ion-item",8),o.j41(11,"div",10)(12,"p",11)(13,"strong"),o.EFF(14,"Fecha de creaci\xf3n:"),o.k0s(),o.EFF(15),o.k0s(),o.j41(16,"div",12),o.DNE(17,ao,4,1,"p",13),o.j41(18,"ion-chip",14),o.EFF(19),o.k0s()(),o.DNE(20,co,7,1,"div",15),o.k0s()(),o.j41(21,"div",16)(22,"h3",17),o.EFF(23,"Precio"),o.k0s(),o.DNE(24,xo,31,12,"ion-list",18),o.j41(25,"div",19)(26,"span"),o.EFF(27,"Total"),o.k0s(),o.j41(28,"strong"),o.EFF(29),o.nI1(30,"number"),o.nI1(31,"currency"),o.k0s()()()(),o.DNE(32,Eo,6,2,"div",20),o.k0s()),2&e){const i=o.XpG();o.Y8G("formGroup",i.form),o.R7$(),o.Y8G("ngIf",i.roleLoaded),o.R7$(),o.Y8G("ngIf",i.isReadOnly&&!i.isSocio),o.R7$(),o.Y8G("ngIf",i.isSocio),o.R7$(),o.Y8G("ngIf",!i.isReadOnly&&!i.isSocio),o.R7$(3),o.Y8G("ngIf",i.isReadOnly),o.R7$(),o.Y8G("ngIf",!i.isReadOnly),o.R7$(),o.Y8G("ngIf",i.isReadOnly),o.R7$(),o.Y8G("ngIf",!i.isReadOnly),o.R7$(5),o.SpI(" ",i.form.value.creacionLetra,""),o.R7$(2),o.Y8G("ngIf",i.isReadOnly),o.R7$(),o.Y8G("color",i.estaVigente?"success":"danger"),o.R7$(),o.JRh(i.estaVigente?"Vigente":"No vigente"),o.R7$(),o.Y8G("ngIf",!i.isReadOnly&&!i.isSocio),o.R7$(4),o.Y8G("ngIf",!i.isSocio),o.R7$(5),o.SpI(" ",1===i.form.value.tipoComision?o.i5U(30,17,i.totalCalculado,"1.2-2")+"%":o.ii3(31,20,i.totalCalculado,"MXN","symbol","1.2-2")," "),o.R7$(3),o.Y8G("ngIf",!i.isSocio&&!i.isReadOnly)}}let U=(()=>{var e;class a{get unidad(){var t;return 1===(null===(t=this.form)||void 0===t||null===(t=t.value)||void 0===t?void 0:t.tipoComision)?"%":"MXN"}get estaVigente(){var t;const n=null===(t=this.form)||void 0===t||null===(t=t.value)||void 0===t?void 0:t.fechaCaducidad;if(!n)return!0;const l=new Date(n);l.setHours(0,0,0,0);const r=new Date;return r.setHours(0,0,0,0),l>=r}constructor(t,n,l,r){this.fb=t,this.modalCtrl=n,this.productoService=l,this.usuarioService=r,this.productoId=0,this.isSocio=!1,this.isReadOnly=!0,this.roleLoaded=!1,this.saving=!1,this.totalCalculado=0,this.minVigencia="1900-01-01",this.maxVigencia="2100-12-31"}ngOnInit(){this.form=this.fb.group({id:[0],nombre:["",[v.k0.required,v.k0.maxLength(200)]],descripcion:["",[v.k0.maxLength(2e3)]],tipoComision:[1],nivel1:[0],nivel2:[0],nivel3:[0],nivel4:[0],nivelInvitacion:[0],nivelMaster:[0],fechaCaducidad:[null],vigenciaLetra:[""],creacionLetra:[""]}),this.form.valueChanges.subscribe(()=>this.recalcularTotal()),this.usuarioService.getUsuario(!0).subscribe({next:t=>{var n;const l=null==t||null===(n=t.data)||void 0===n||null===(n=n.roles)||void 0===n?void 0:n.enumValue;this.isSocio=2===l,this.isReadOnly=!0,this.roleLoaded=!0},error:()=>{this.isSocio=!1,this.roleLoaded=!0}}),this.loadData()}formatMonto(t){var n;const l=Number(t||0);return 1===(null===(n=this.form)||void 0===n||null===(n=n.value)||void 0===n?void 0:n.tipoComision)?`${l.toFixed(2)}%`:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(l)}onToggleChange(t){this.isReadOnly=!t.detail.checked,setTimeout(()=>this.form.updateValueAndValidity(),0)}loadData(){this.productoService.getProductoById(this.productoId).subscribe({next:t=>{var n,l,r,s,d,u,m,g,f,F,C,h;const _=null!=t&&t.vigencia?new Date(t.vigencia).toISOString():null;this.original={id:null!==(n=null==t?void 0:t.id)&&void 0!==n?n:0,nombre:null!==(l=null==t?void 0:t.nombre)&&void 0!==l?l:"",descripcion:null!==(r=null==t?void 0:t.descripcion)&&void 0!==r?r:"",tipoComision:null!==(s=null==t?void 0:t.tipoComision)&&void 0!==s?s:1,nivel1:null!==(d=null==t?void 0:t.nivel1)&&void 0!==d?d:0,nivel2:null!==(u=null==t?void 0:t.nivel2)&&void 0!==u?u:0,nivel3:null!==(m=null==t?void 0:t.nivel3)&&void 0!==m?m:0,nivel4:null!==(g=null==t?void 0:t.nivel4)&&void 0!==g?g:0,nivelInvitacion:null!==(f=null==t?void 0:t.nivelInvitacion)&&void 0!==f?f:0,nivelMaster:null!==(F=null==t?void 0:t.nivelMaster)&&void 0!==F?F:0,fechaCaducidad:_,vigenciaLetra:null!==(C=null==t?void 0:t.vigenciaLetra)&&void 0!==C?C:"",creacionLetra:null!==(h=null==t?void 0:t.creacionLetra)&&void 0!==h?h:""},this.form.reset(this.original,{emitEvent:!1}),this.recalcularTotalFrom(this.original),this.form.markAsPristine(),this.form.markAsUntouched()}})}reset(){this.original&&(this.form.reset(this.original,{emitEvent:!1}),this.recalcularTotalFrom(this.original),this.form.markAsPristine(),this.form.markAsUntouched(),this.isReadOnly=!0)}recalcularTotalFrom(t){this.totalCalculado=Number(t.nivel1||0)+Number(t.nivel2||0)+Number(t.nivel3||0)+Number(t.nivel4||0)+Number(t.nivelInvitacion||0)+Number(t.nivelMaster||0)}recalcularTotal(){this.recalcularTotalFrom(this.form.getRawValue())}guardar(){var t=this;if(this.form.invalid)return;const n=this.form.getRawValue(),l=n.fechaCaducidad?new Date(n.fechaCaducidad):null,r={id:n.id,nombre:n.nombre,descripcion:n.descripcion,tipoComision:n.tipoComision,fechaCaducidad:l,nivel1:n.nivel1,nivel2:n.nivel2,nivel3:n.nivel3,nivel4:n.nivel4,nivelInvitacion:n.nivelInvitacion,nivelMaster:n.nivelMaster};var s;this.saving=!0,this.productoService.save(r).subscribe({next:(s=(0,E.A)(function*(d){t.saving=!1,null!=d&&d.success&&(yield t.modalCtrl.dismiss(!0))}),function(u){return s.apply(this,arguments)}),error:()=>{this.saving=!1}})}}return(e=a).\u0275fac=function(t){return new(t||e)(o.rXU(v.ok),o.rXU(c.W3),o.rXU(V),o.rXU(w.o))},e.\u0275cmp=o.VBU({type:e,selectors:[["app-modal-editar-producto"]],inputs:{productoId:"productoId"},decls:1,vars:1,consts:[["class","producto-modal-content",3,"formGroup",4,"ngIf"],[1,"producto-modal-content",3,"formGroup"],["class","top-row",4,"ngIf"],["class","hint","color","medium",4,"ngIf"],["class","hint warn","color","warning",4,"ngIf"],[1,"modal-body"],[1,"modal-info"],["class","title",4,"ngIf"],["class","editable-field","lines","none",4,"ngIf"],["class","modal-descripcion",4,"ngIf"],[1,"modal-fechas"],[1,"sutil"],[1,"vigencia-row"],["class","sutil",4,"ngIf"],["outline","",3,"color"],["class","editable-field",4,"ngIf"],[1,"modal-comisiones"],[1,"section-title"],["lines","full","class","price-list",4,"ngIf"],[1,"total-row"],["class","sticky-actions",4,"ngIf"],[1,"top-row"],["outline","true",3,"color"],[3,"name"],[1,"spacer"],["class","toggle-item","lines","none",4,"ngIf"],["lines","none",1,"toggle-item"],[3,"ionChange","checked"],["color","medium",1,"hint"],["name","information-circle-outline"],["name","lock-closed-outline"],["color","warning",1,"hint","warn"],["type","button",1,"link",3,"click"],[1,"title"],["lines","none",1,"editable-field"],["position","stacked"],["formControlName","nombre","placeholder","Nombre"],[1,"modal-descripcion"],["formControlName","descripcion","autoGrow","true","rows","4","placeholder","Descripci\xf3n"],[1,"editable-field"],[1,"stacked-label"],[1,"date-inline"],["datetime","vigenciaPicker",1,"dt-btn"],[3,"keepContentsMounted"],["id","vigenciaPicker","formControlName","fechaCaducidad","presentation","date","locale","es-MX","first-day-of-week","1","cancelText","Cancelar","doneText","Aceptar",3,"preferWheel","min","max","showDefaultButtons"],["lines","full",1,"price-list"],["slot","end",4,"ngIf"],["slot","end","class","input-wrap",4,"ngIf"],["slot","end"],["slot","end",1,"input-wrap"],["type","number","inputmode","decimal","step","0.01","formControlName","nivel1"],[1,"suffix"],["type","number","inputmode","decimal","step","0.01","formControlName","nivel2"],["type","number","inputmode","decimal","step","0.01","formControlName","nivel3"],["type","number","inputmode","decimal","step","0.01","formControlName","nivel4"],["type","number","inputmode","decimal","step","0.01","formControlName","nivelInvitacion"],["type","number","inputmode","decimal","step","0.01","formControlName","nivelMaster"],[1,"sticky-actions"],["fill","clear",3,"click"],["color","primary",3,"click","disabled"]],template:function(t,n){1&t&&o.DNE(0,ko,33,25,"form",0),2&t&&o.Y8G("ngIf",n.form)},dependencies:[b.MD,b.bT,b.QX,b.oe,v.YN,v.qT,v.BC,v.cb,v.X1,v.j4,v.JD,c.bv,c.Jm,c.ZB,c.A9,c.K4,c.iq,c.$w,c.uz,c.he,c.nf,c.JI,c.nc,c.BY,c.Sb,c.hB,c.su,c.Je,c.Gw],styles:[".producto-modal-content[_ngcontent-%COMP%]{padding:16px 16px 72px;background:#fff;color:#2f2f2f;max-height:85vh;overflow-y:auto;font-family:system-ui,Segoe UI,Tahoma,sans-serif}.top-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:8px}.top-row[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{flex:1}.top-row[_ngcontent-%COMP%]   .toggle-item[_ngcontent-%COMP%]{--inner-padding-end: 0}.hint[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin:4px 0 12px;font-size:13px}.hint.warn[_ngcontent-%COMP%]{color:#b36b00}.hint[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{background:none;border:0;color:var(--ion-color-primary);text-decoration:underline;cursor:pointer;padding:0 2px}.modal-body[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 360px;gap:28px}.title[_ngcontent-%COMP%]{margin:0 0 6px}.modal-descripcion[_ngcontent-%COMP%]{font-size:15px;line-height:1.6;margin:10px 0 18px}.sutil[_ngcontent-%COMP%]{color:#6b7280}.vigencia-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin-bottom:10px}.stacked-label[_ngcontent-%COMP%]{display:block;font-size:13px;color:#6b7280;margin-bottom:6px}.editable-field[_ngcontent-%COMP%]{background:#fafafa;border:1px dashed #d1d5db;border-radius:10px;padding:10px 12px;margin:8px 0 14px}.editable-field[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%], .editable-field[_ngcontent-%COMP%]   ion-textarea[_ngcontent-%COMP%]{--padding-start: 0}.date-inline[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.dt-btn[_ngcontent-%COMP%]{--background: #eef2ff;--color: var(--ion-color-primary);border-radius:10px;padding-inline:10px}.modal-comisiones[_ngcontent-%COMP%]{background:#fafafa;border:1px solid #eee;border-radius:12px;padding:14px;align-self:start}.section-title[_ngcontent-%COMP%]{margin:0 0 8px;color:#1e8449;font-size:18px}.price-list[_ngcontent-%COMP%]   .input-wrap[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px}.price-list[_ngcontent-%COMP%]   .suffix[_ngcontent-%COMP%]{min-width:40px;text-align:right}.total-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-top:2px solid #ddd;padding-top:10px;margin-top:12px;font-size:16px}.sticky-actions[_ngcontent-%COMP%]{position:sticky;bottom:0;left:0;right:0;display:flex;align-items:center;gap:8px;padding:10px 0 0;background:linear-gradient(to top,#fff,#ffffffd9)}.modal-body[_ngcontent-%COMP%]{display:grid;grid-template-columns:1.2fr 520px;gap:32px}.title[_ngcontent-%COMP%]{font-size:28px;line-height:1.15;margin:0 0 8px}.modal-descripcion[_ngcontent-%COMP%]{font-size:16px;line-height:1.7}.section-title[_ngcontent-%COMP%]{font-size:19px}@media (max-width: 820px){.modal-body[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}}"]}),a})();var Ro=p(980),$=function(e){return e[e.CantidadFija=0]="CantidadFija",e[e.Porcentaje=1]="Porcentaje",e}($||{});const $o={CantidadFija:"Cantidad",Porcentaje:"Porcentaje"};var Io=p(6704),z=p(3746),G=p(3069),Mo=p(3),S=p(6152),yo=p(5460),J=p(8311),Go=p(4596),T=p(3191);const To=["class","producto form"],Do=()=>({header:"Selecciona empresa"}),No=()=>({header:"Tipo de comision"});function Vo(e,a){1&e&&(o.j41(0,"ion-text",21),o.EFF(1," Campo requerido "),o.k0s())}function So(e,a){1&e&&(o.j41(0,"ion-text",21),o.EFF(1," Campo requerido "),o.k0s())}function Ao(e,a){1&e&&(o.j41(0,"ion-text",21),o.EFF(1," Campo requerido "),o.k0s())}function Bo(e,a){if(1&e&&(o.j41(0,"ion-select-option",24),o.EFF(1),o.k0s()),2&e){const i=a.$implicit;o.Y8G("value",i.id),o.R7$(),o.Lme(" ",i.rfc," - ",i.razonSocial," ")}}function Xo(e,a){1&e&&(o.j41(0,"ion-text",21),o.EFF(1," Campo requerido "),o.k0s())}function Oo(e,a){if(1&e){const i=o.RV6();o.j41(0,"ion-row")(1,"ion-col",19)(2,"ion-select",22),o.bIt("ionBlur",function(){let n;o.eBV(i);const l=o.XpG(2);return o.Njj(null==(n=l.getControl("empresa"))?null:n.markAsTouched())}),o.DNE(3,Bo,2,3,"ion-select-option",23),o.k0s(),o.DNE(4,Xo,2,0,"ion-text",13),o.k0s()()}if(2&e){let i,t;const n=o.XpG(2);o.R7$(2),o.AVh("invalid",(null==(i=n.getControl("empresa"))?null:i.invalid)&&(null==(i=n.getControl("empresa"))?null:i.touched)),o.Y8G("interfaceOptions",o.lJ4(5,Do)),o.R7$(),o.Y8G("ngForOf",n.empresas),o.R7$(),o.Y8G("ngIf",(null==(t=n.getControl("empresa"))?null:t.invalid)&&(null==(t=n.getControl("empresa"))?null:t.touched))}}function Yo(e,a){if(1&e){const i=o.RV6();o.qex(0),o.j41(1,"ion-row")(2,"ion-col",11)(3,"ion-input",12),o.bIt("ionBlur",function(){let n;o.eBV(i);const l=o.XpG();return o.Njj(null==(n=l.getControl("nombre"))?null:n.markAsTouched())}),o.k0s(),o.DNE(4,Vo,2,0,"ion-text",13),o.k0s(),o.j41(5,"ion-col",14)(6,"mat-form-field",15)(7,"mat-label"),o.EFF(8,"Fecha de vencimiento"),o.k0s(),o.nrm(9,"input",16),o.j41(10,"mat-hint"),o.EFF(11,"DD/MM/YYYY"),o.k0s(),o.nrm(12,"mat-datepicker-toggle",17)(13,"mat-datepicker",18,0),o.k0s(),o.DNE(15,So,2,0,"ion-text",13),o.k0s()(),o.j41(16,"ion-row")(17,"ion-col",19),o.nrm(18,"ion-input",20),o.DNE(19,Ao,2,0,"ion-text",13),o.k0s()(),o.DNE(20,Oo,5,6,"ion-row",8),o.bVm()}if(2&e){let i,t,n,l,r;const s=o.sdS(14),d=o.XpG();o.R7$(3),o.AVh("invalid",(null==(i=d.getControl("nombre"))?null:i.invalid)&&(null==(i=d.getControl("nombre"))?null:i.touched)),o.R7$(),o.Y8G("ngIf",(null==(t=d.getControl("nombre"))?null:t.invalid)&&(null==(t=d.getControl("nombre"))?null:t.touched)),o.R7$(5),o.Y8G("matDatepicker",s),o.R7$(3),o.Y8G("for",s),o.R7$(3),o.Y8G("ngIf",(null==(n=d.getControl("fechaVencimiento"))?null:n.invalid)&&(null==(n=d.getControl("fechaVencimiento"))?null:n.touched)),o.R7$(3),o.AVh("invalid",(null==(l=d.getControl("descripcion"))?null:l.invalid)&&(null==(l=d.getControl("descripcion"))?null:l.touched)),o.R7$(),o.Y8G("ngIf",(null==(r=d.getControl("descripcion"))?null:r.invalid)&&(null==(r=d.getControl("descripcion"))?null:r.touched)),o.R7$(),o.Y8G("ngIf",d.mostrarEmpresas)}}function wo(e,a){if(1&e&&(o.j41(0,"ion-select-option",24),o.EFF(1),o.k0s()),2&e){const i=a.$implicit;o.Y8G("value",i.valor),o.R7$(),o.SpI(" ",i.nombre," ")}}function Uo(e,a){1&e&&(o.j41(0,"ion-text",21),o.EFF(1," Campo requerido "),o.k0s())}function zo(e,a){1&e&&(o.j41(0,"ion-text",21),o.EFF(1," Campo requerido "),o.k0s())}function Jo(e,a){1&e&&(o.j41(0,"ion-text",21),o.EFF(1," Campo requerido "),o.k0s())}function Lo(e,a){1&e&&(o.j41(0,"ion-text",21),o.EFF(1," Campo requerido "),o.k0s())}function qo(e,a){1&e&&(o.j41(0,"ion-text",21),o.EFF(1," Campo requerido "),o.k0s())}function Ho(e,a){1&e&&(o.j41(0,"ion-text",21),o.EFF(1," Campo requerido "),o.k0s())}function Qo(e,a){1&e&&(o.j41(0,"ion-text",21),o.EFF(1," Campo requerido "),o.k0s())}function Wo(e,a){if(1&e){const i=o.RV6();o.qex(0),o.j41(1,"ion-row")(2,"ion-col",25)(3,"strong"),o.EFF(4,"Producto:"),o.k0s(),o.EFF(5),o.k0s(),o.j41(6,"ion-col",25)(7,"ion-select",26),o.bIt("ionChange",function(n){o.eBV(i);const l=o.XpG();return o.Njj(l.onTipoComisionChange(n))})("ionBlur",function(){let n;o.eBV(i);const l=o.XpG();return o.Njj(null==(n=l.getControl("tipoComision"))?null:n.markAsTouched())}),o.DNE(8,wo,2,2,"ion-select-option",23),o.k0s(),o.DNE(9,Uo,2,0,"ion-text",13),o.k0s()(),o.j41(10,"ion-row",27)(11,"ion-col",28)(12,"ion-input",29),o.bIt("ionBlur",function(){let n;o.eBV(i);const l=o.XpG();return o.Njj(null==(n=l.getControl("nivel_1"))?null:n.markAsTouched())}),o.k0s(),o.DNE(13,zo,2,0,"ion-text",13),o.k0s(),o.j41(14,"ion-col",28)(15,"ion-input",30),o.bIt("ionBlur",function(){let n;o.eBV(i);const l=o.XpG();return o.Njj(null==(n=l.getControl("nivel_2"))?null:n.markAsTouched())}),o.k0s(),o.DNE(16,Jo,2,0,"ion-text",13),o.k0s(),o.j41(17,"ion-col",28)(18,"ion-input",31),o.bIt("ionBlur",function(){let n;o.eBV(i);const l=o.XpG();return o.Njj(null==(n=l.getControl("nivel_3"))?null:n.markAsTouched())}),o.k0s(),o.DNE(19,Lo,2,0,"ion-text",13),o.k0s(),o.j41(20,"ion-col",28)(21,"ion-input",32),o.bIt("ionBlur",function(){let n;o.eBV(i);const l=o.XpG();return o.Njj(null==(n=l.getControl("nivel_4"))?null:n.markAsTouched())}),o.k0s(),o.DNE(22,qo,2,0,"ion-text",13),o.k0s(),o.j41(23,"ion-col",28)(24,"ion-input",33),o.bIt("ionBlur",function(){let n;o.eBV(i);const l=o.XpG();return o.Njj(null==(n=l.getControl("nivel_invitacion"))?null:n.markAsTouched())}),o.k0s(),o.DNE(25,Ho,2,0,"ion-text",13),o.k0s(),o.j41(26,"ion-col",28)(27,"ion-input",34),o.bIt("ionBlur",function(){let n;o.eBV(i);const l=o.XpG();return o.Njj(null==(n=l.getControl("nivel_master"))?null:n.markAsTouched())}),o.k0s(),o.DNE(28,Qo,2,0,"ion-text",13),o.k0s()(),o.bVm()}if(2&e){let i,t,n,l,r,s,d,u,m,g,f,F,C,h;const _=o.XpG();o.R7$(5),o.SpI(" ",_.nombreProductoAgregando," "),o.R7$(2),o.AVh("invalid",(null==(i=_.getControl("tipoComision"))?null:i.invalid)&&(null==(i=_.getControl("tipoComision"))?null:i.touched)),o.Y8G("interfaceOptions",o.lJ4(24,No)),o.R7$(),o.Y8G("ngForOf",_.tiposComision),o.R7$(),o.Y8G("ngIf",(null==(t=_.getControl("tipoComision"))?null:t.invalid)&&(null==(t=_.getControl("tipoComision"))?null:t.touched)),o.R7$(3),o.AVh("invalid",(null==(n=_.getControl("nivel_1"))?null:n.invalid)&&(null==(n=_.getControl("nivel_1"))?null:n.touched)),o.R7$(),o.Y8G("ngIf",(null==(l=_.getControl("nivel_1"))?null:l.invalid)&&(null==(l=_.getControl("nivel_1"))?null:l.touched)),o.R7$(2),o.AVh("invalid",(null==(r=_.getControl("nivel_2"))?null:r.invalid)&&(null==(r=_.getControl("nivel_2"))?null:r.touched)),o.R7$(),o.Y8G("ngIf",(null==(s=_.getControl("nivel_2"))?null:s.invalid)&&(null==(s=_.getControl("nivel_2"))?null:s.touched)),o.R7$(2),o.AVh("invalid",(null==(d=_.getControl("nivel_3"))?null:d.invalid)&&(null==(d=_.getControl("nivel_3"))?null:d.touched)),o.R7$(),o.Y8G("ngIf",(null==(u=_.getControl("nivel_3"))?null:u.invalid)&&(null==(u=_.getControl("nivel_3"))?null:u.touched)),o.R7$(2),o.AVh("invalid",(null==(m=_.getControl("nivel_4"))?null:m.invalid)&&(null==(m=_.getControl("nivel_4"))?null:m.touched)),o.R7$(),o.Y8G("ngIf",(null==(g=_.getControl("nivel_4"))?null:g.invalid)&&(null==(g=_.getControl("nivel_4"))?null:g.touched)),o.R7$(2),o.AVh("invalid",(null==(f=_.getControl("nivel_invitacion"))?null:f.invalid)&&(null==(f=_.getControl("nivel_invitacion"))?null:f.touched)),o.R7$(),o.Y8G("ngIf",(null==(F=_.getControl("nivel_invitacion"))?null:F.invalid)&&(null==(F=_.getControl("nivel_invitacion"))?null:F.touched)),o.R7$(2),o.AVh("invalid",(null==(C=_.getControl("nivel_master"))?null:C.invalid)&&(null==(C=_.getControl("nivel_master"))?null:C.touched)),o.R7$(),o.Y8G("ngIf",(null==(h=_.getControl("nivel_master"))?null:h.invalid)&&(null==(h=_.getControl("nivel_master"))?null:h.touched))}}function Zo(e,a){if(1&e&&(o.j41(0,"span"),o.EFF(1),o.k0s()),2&e){const i=o.XpG(2);o.R7$(),o.SpI(" Pagar\xe1s ",i.comisionTotalProductoAgregando," por cada una de las referencias que se hagan v\xe1lidas para este producto ")}}function Ko(e,a){if(1&e&&(o.j41(0,"span"),o.EFF(1),o.nrm(2,"br"),o.j41(3,"small"),o.EFF(4,"Deber\xe1s indicar el importe con el cual la venta del producto fue cerrada para determinar los valores de cada una de las comisiones a repartir"),o.k0s()()),2&e){const i=o.XpG(2);o.R7$(),o.SpI(" Pagar\xe1s un ",i.comisionTotalProductoAgregando," por cada una de las referencias que se hagan v\xe1lidas para este producto. ")}}function ot(e,a){if(1&e){const i=o.RV6();o.qex(0),o.j41(1,"ion-row")(2,"ion-col",28)(3,"strong"),o.EFF(4,"Producto: "),o.k0s(),o.EFF(5),o.nrm(6,"br"),o.j41(7,"small"),o.EFF(8),o.nrm(9,"br")(10,"br"),o.j41(11,"strong"),o.EFF(12,"Vigencia: "),o.k0s(),o.EFF(13),o.nrm(14,"br"),o.EFF(15," Valida los datos del producto que publicar\xe1s. "),o.nrm(16,"br"),o.EFF(17," Una vez que el producto ha sido publicado, no podr\xe1 ser modificado. "),o.k0s()(),o.j41(18,"ion-col",28)(19,"table",35)(20,"tr")(21,"th",36),o.EFF(22,"Tabla de comisiones"),o.k0s()(),o.j41(23,"tr")(24,"th",37),o.EFF(25,"Nivel 1"),o.k0s(),o.j41(26,"td",38),o.EFF(27),o.k0s()(),o.j41(28,"tr")(29,"th",37),o.EFF(30,"Nivel 2"),o.k0s(),o.j41(31,"td",38),o.EFF(32),o.k0s()(),o.j41(33,"tr")(34,"th",37),o.EFF(35,"Nivel 3"),o.k0s(),o.j41(36,"td",38),o.EFF(37),o.k0s()(),o.j41(38,"tr")(39,"th",37),o.EFF(40,"Nivel 4"),o.k0s(),o.j41(41,"td",38),o.EFF(42),o.k0s()(),o.j41(43,"tr")(44,"th",37),o.EFF(45,"Invitador"),o.k0s(),o.j41(46,"td",38),o.EFF(47),o.k0s()(),o.j41(48,"tr")(49,"th",37),o.EFF(50,"Embassy"),o.k0s(),o.j41(51,"td",38),o.EFF(52),o.k0s()(),o.j41(53,"tr")(54,"th",37),o.EFF(55,"Total"),o.k0s(),o.j41(56,"th",38),o.EFF(57),o.k0s()()()()(),o.j41(58,"ion-row")(59,"ion-col",19),o.DNE(60,Zo,2,1,"span",8)(61,Ko,5,1,"span",8),o.k0s()(),o.j41(62,"ion-row")(63,"ion-col")(64,"ion-checkbox",39),o.bIt("ionChange",function(n){o.eBV(i);const l=o.XpG();return o.Njj(l.confirmacionProductoAgregado=n.detail.checked)}),o.EFF(65," Acepto los T\xe9rminos y Condiciones y la "),o.j41(66,"a",40),o.EFF(67,"Pol\xedtica de Privacidad"),o.k0s()()()(),o.bVm()}if(2&e){const i=o.XpG();o.R7$(5),o.SpI(" ",i.nombreProductoAgregando,""),o.R7$(3),o.SpI(" ",i.descripcionProductoAgregando,""),o.R7$(5),o.SpI(" ",i.fechaVigenciaTextoAgregando,""),o.R7$(14),o.JRh(i.nivel1ProductoAgregando),o.R7$(5),o.JRh(i.nivel2ProductoAgregando),o.R7$(5),o.JRh(i.nivel3ProductoAgregando),o.R7$(5),o.JRh(i.nivel4ProductoAgregando),o.R7$(5),o.JRh(i.nivelInvitacionProductoAgregando),o.R7$(5),o.JRh(i.nivelMasterProductoAgregando),o.R7$(5),o.JRh(i.comisionTotalProductoAgregando),o.R7$(3),o.Y8G("ngIf",0==i.tipoComisionAgregando),o.R7$(),o.Y8G("ngIf",1==i.tipoComisionAgregando),o.R7$(3),o.Y8G("checked",i.confirmacionProductoAgregado)}}function tt(e,a){if(1&e){const i=o.RV6();o.j41(0,"div",41)(1,"ion-button",42),o.bIt("click",function(){o.eBV(i);const n=o.XpG();return o.Njj(n.siguientePaso(1))}),o.EFF(2,"Continuar"),o.k0s()()}if(2&e){const i=o.XpG();o.R7$(),o.Y8G("disabled",i.formEnviado)}}function et(e,a){if(1&e){const i=o.RV6();o.j41(0,"div",41)(1,"ion-button",42),o.bIt("click",function(){o.eBV(i);const n=o.XpG();return o.Njj(n.pasoAnterior(1))}),o.EFF(2,"Regresar"),o.k0s()()}if(2&e){const i=o.XpG();o.R7$(),o.Y8G("disabled",i.formEnviado)}}function nt(e,a){if(1&e){const i=o.RV6();o.j41(0,"div",41)(1,"ion-button",42),o.bIt("click",function(){o.eBV(i);const n=o.XpG();return o.Njj(n.siguientePaso(2))}),o.EFF(2,"Validar"),o.k0s()()}if(2&e){const i=o.XpG();o.R7$(),o.Y8G("disabled",i.formEnviado)}}function it(e,a){if(1&e){const i=o.RV6();o.j41(0,"div",41)(1,"ion-button",42),o.bIt("click",function(){o.eBV(i);const n=o.XpG();return o.Njj(n.pasoAnterior(2))}),o.EFF(2,"Regresar"),o.k0s()()}if(2&e){const i=o.XpG();o.R7$(),o.Y8G("disabled",i.formEnviado)}}function lt(e,a){if(1&e){const i=o.RV6();o.j41(0,"div",41)(1,"ion-button",42),o.bIt("click",function(){o.eBV(i);const n=o.XpG();return o.Njj(n.enviarFormulario())}),o.EFF(2," PUBLICAR "),o.k0s()()}if(2&e){const i=o.XpG();o.R7$(),o.Y8G("disabled",i.formEnviado||!i.confirmacionProductoAgregado)}}let rt=(()=>{var e;class a{constructor(t,n,l,r,s,d,u,m,g){this.fb=t,this.toastController=n,this.loadingCtrl=l,this.empresasService=r,this.productoService=s,this.usuarioService=d,this.cdr=u,this.utilerias=m,this.modalCtrl=g,this.btnName="AGREGAR",this.title="AGREGAR",this.formEnviado=!1,this.tiposComision=[],this.id=void 0,this.TipoComisionEnum=$,this.empresas=[],this.mostrarEmpresas=!1,this.empresaID=0,this.estatusDatosbasicos=1,this.estatusDatosComisiones=0,this.estatusDatosValidacion=0,this.nombreProductoAgregando="",this.descripcionProductoAgregando="",this.vigenciaProductoAgregando="",this.nivel1ProductoAgregando="",this.nivel2ProductoAgregando="",this.nivel3ProductoAgregando="",this.nivel4ProductoAgregando="",this.nivelInvitacionProductoAgregando="",this.nivelMasterProductoAgregando="",this.comisionTotalProductoAgregando="",this.tipoComisionAgregando=0,this.fechaVigenciaTextoAgregando="",this.confirmacionProductoAgregado=!1,this.pasoActual="Descripci\xf3n";let f=this.obtenerUltimoDiaDeTresMesesDespues();this.formulario=this.fb.group({nombre:["",[v.k0.required,(0,yo.a)()]],descripcion:[""],fechaVencimiento:[f,v.k0.required],empresa:[""],tipoComision:["",v.k0.required],comisionCantidad:[""],comisionPorcentaje:[""],cantidadPorcentaje:[""],otroTipoComision:["",v.k0.required],nivel_1:["",v.k0.required],nivel_2:["",v.k0.required],nivel_3:["",v.k0.required],nivel_4:["",v.k0.required],nivel_master:["",v.k0.required],nivel_invitacion:["",v.k0.required]})}obtenerUltimoDiaDeTresMesesDespues(){const t=new Date,n=new Date(t.getFullYear(),t.getMonth()+13,1);return new Date(n.getFullYear(),n.getMonth(),0)}siguientePaso(t){this.confirmacionProductoAgregado=!1,this.nombreProductoAgregando=(0,S.H)(this.formulario.controls.nombre.value),this.descripcionProductoAgregando=this.formulario.controls.descripcion.value,this.fechaVigenciaTextoAgregando=this.utilerias.formatearFecha(this.formulario.controls.fechaVencimiento.value);let n=this.formulario.controls.tipoComision.value;this.tipoComisionAgregando=n;let l=Number.parseFloat(this.formulario.controls.nivel_1.value),r=Number.parseFloat(this.formulario.controls.nivel_2.value),s=Number.parseFloat(this.formulario.controls.nivel_3.value),d=Number.parseFloat(this.formulario.controls.nivel_4.value),u=Number.parseFloat(this.formulario.controls.nivel_invitacion.value),m=Number.parseFloat(this.formulario.controls.nivel_master.value),g=l+r+s+d+u+m;0==n&&(this.nivel1ProductoAgregando="$"+l.toFixed(2)+" MXN",this.nivel2ProductoAgregando="$"+r.toFixed(2)+"MXN",this.nivel3ProductoAgregando="$"+s.toFixed(2)+"MXN",this.nivel4ProductoAgregando="$"+d.toFixed(2)+"MXN",this.nivelInvitacionProductoAgregando="$"+u.toFixed(2)+"MXN",this.nivelMasterProductoAgregando="$"+m.toFixed(2)+"MXN",this.comisionTotalProductoAgregando="$"+g.toFixed(2)+"MXN"),1==n&&(this.nivel1ProductoAgregando=l.toFixed(2)+"%",this.nivel2ProductoAgregando=r.toFixed(2)+"%",this.nivel3ProductoAgregando=s.toFixed(2)+"%",this.nivel4ProductoAgregando=d.toFixed(2)+"%",this.nivelInvitacionProductoAgregando=u.toFixed(2)+"%",this.nivelMasterProductoAgregando=m.toFixed(2)+"%",this.comisionTotalProductoAgregando=g.toFixed(2)+"%"),1==t&&(this.estatusDatosbasicos=0,this.estatusDatosComisiones=1,this.estatusDatosValidacion=0,this.pasoActual="Comisiones"),2==t&&(this.estatusDatosbasicos=0,this.estatusDatosComisiones=0,this.estatusDatosValidacion=1,this.pasoActual="Validaci\xf3n")}pasoAnterior(t){this.confirmacionProductoAgregado=!1,1==t&&(this.estatusDatosbasicos=1,this.estatusDatosComisiones=0,this.estatusDatosValidacion=0,this.pasoActual="Descripci\xf3n"),2==t&&(this.estatusDatosbasicos=0,this.estatusDatosComisiones=1,this.estatusDatosValidacion=0,this.pasoActual="Comisiones")}ngOnInit(){var t=this;return(0,E.A)(function*(){t.tiposComision=function jo(){return Object.keys($).filter(e=>isNaN(Number(e))).map(e=>({nombre:$o[e],valor:$[e]}))}();const n=yield t.loadingCtrl.create({message:"Cargando datos..."});yield n.present();try{var l,r;const s=yield(0,k._)(t.empresasService.getAllEmpresas());t.empresas=(null==s?void 0:s.data)||[];const d=yield(0,k._)(t.usuarioService.getUsuario()),u=null==d?void 0:d.data;if(t.rolUser=null===(l=u.roles)||void 0===l?void 0:l.enumValue,(null===(r=u.roles)||void 0===r?void 0:r.enumValue)==x.$u.Admin){t.mostrarEmpresas=!0;const m=t.formulario.get("empresa");null==m||m.setValidators([v.k0.required]),null==m||m.updateValueAndValidity(),t.cdr.detectChanges()}else{const m=yield(0,k._)(t.usuarioService.getEmpresaByUsuario(u.id));t.empresaID=null==m?void 0:m.data.id}}catch(s){console.error("Error al cargar datos",s)}finally{n.dismiss()}})()}enviarFormulario(){if(this.formulario.controls.fechaVencimiento.value<new Date)return this.toastController.create({message:"Fecha de vencimiento tiene que ser superior a la actual.",duration:3e3,color:"warning",position:"top"}).then(s=>s.present()),void(this.formEnviado=!1);const l=this.rolUser==x.$u.Admin?this.formulario.controls.empresa.value:this.empresaID;var r={nombre:(0,S.H)(this.formulario.controls.nombre.value),descripcion:(0,S.H)(this.formulario.controls.descripcion.value),empresaID:l,fechaCaducidad:this.formulario.controls.fechaVencimiento.value,nivel1:this.formulario.controls.nivel_1.value,nivel2:this.formulario.controls.nivel_2.value,nivel3:this.formulario.controls.nivel_3.value,nivel4:this.formulario.controls.nivel_4.value,nivelInvitacion:this.formulario.controls.nivel_invitacion.value,nivelMaster:this.formulario.controls.nivel_master.value,tipoComision:this.formulario.controls.tipoComision.value};this.productoService.save(r).pipe((0,Ro.j)(()=>{this.formEnviado=!1})).subscribe({next:s=>{s&&(this.toastController.create({message:"producto guardado.",duration:3e3,color:"success",position:"top"}).then(d=>d.present()),this.modalCtrl.dismiss(!0))}})}getControl(t){return this.formulario.get(t)}close(){this.modalCtrl.dismiss()}onTipoComisionChange(t){const n=t.detail.value,l=this.formulario.get("comisionCantidad"),r=this.formulario.get("comisionPorcentaje"),s=this.formulario.get("cantidadPorcentaje");switch(n){case $.CantidadFija:null==l||l.setValidators([v.k0.required]),null==r||r.clearValidators(),null==r||r.setValue(""),null==s||s.clearValidators(),null==s||s.setValue("");break;case $.Porcentaje:null==r||r.setValidators([v.k0.required]),null==s||s.setValidators([v.k0.required]),null==l||l.clearValidators(),null==l||l.setValue("")}null==l||l.updateValueAndValidity(),null==r||r.updateValueAndValidity(),null==r||r.updateValueAndValidity()}}return(e=a).\u0275fac=function(t){return new(t||e)(o.rXU(v.ok),o.rXU(c.K_),o.rXU(c.Xi),o.rXU(J.z),o.rXU(V),o.rXU(w.o),o.rXU(o.gRc),o.rXU(Go.M),o.rXU(c.W3))},e.\u0275cmp=o.VBU({type:e,selectors:[["app-modal",8,"producto","form"]],inputs:{id:"id"},features:[o.Jv_([(0,Mo.aw)()])],attrs:To,decls:21,vars:11,consts:[["picker",""],[1,"modalHeader"],["slot","end"],[3,"click"],["name","close"],[1,"ion-padding",3,"fullscreen"],[2,"width","100%","max-width","1100px","margin","0 auto"],[1,"modalform",3,"formGroup"],[4,"ngIf"],[2,"text-align","center"],["style","width:45%;display:inline-block;",4,"ngIf"],["size","8"],["label-placement","floating","label","Nombre del producto","formControlName","nombre","placeholder","Nombre del producto","type","text",1,"inputForm",3,"ionBlur"],["color","danger",4,"ngIf"],["size","4"],["appearance","fill",1,"custom-datepicker"],["matInput","","formControlName","fechaVencimiento",3,"matDatepicker"],["matIconSuffix","",3,"for"],["touchUi",""],["size","12"],["label-placement","floating","label","Descripci\xf3n","placeholder","Descripci\xf3n del producto","type","text","formControlName","descripcion",1,"inputForm"],["color","danger"],["okText","Ok","cancelText","Cancelar","label-placement","floating","label","Empresa","formControlName","empresa",1,"inputForm",3,"ionBlur","interfaceOptions"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["size","6"],["okText","Ok","cancelText","Cancelar","label-placement","floating","label","Tipo de comision","formControlName","tipoComision",1,"inputForm",3,"ionChange","ionBlur","interfaceOptions"],[1,"niveles"],["size","12","size-md","6"],["label-placement","floating","label","Nivel 1","formControlName","nivel_1","placeholder","Nivel 1","type","number","min","0",1,"inputForm",3,"ionBlur"],["label-placement","floating","label","Nivel 2","formControlName","nivel_2","placeholder","Nivel 2","type","number","min","0",1,"inputForm",3,"ionBlur"],["label-placement","floating","label","Nivel 3","formControlName","nivel_3","placeholder","Nivel 3","type","number","min","0",1,"inputForm",3,"ionBlur"],["label-placement","floating","label","Nivel 4","formControlName","nivel_4","placeholder","Nivel 4","type","number","min","0",1,"inputForm",3,"ionBlur"],["label-placement","floating","label","Nivel Invitaci\xf3n","formControlName","nivel_invitacion","placeholder","Nivel Invitaci\xf3n","type","number","min","0",1,"inputForm",3,"ionBlur"],["label-placement","floating","label","Nivel Master","formControlName","nivel_master","placeholder","Nivel Master","type","number","min","0",1,"inputForm",3,"ionBlur"],[2,"width","100%"],["colspan","2"],[2,"text-align","start"],[2,"text-align","end"],["labelPlacement","end",3,"ionChange","checked"],["href","https://www.sistemasperseo.com/Embassy_Terminos_y_Privacidad.pdf"],[2,"width","45%","display","inline-block"],[1,"customButton",3,"click","disabled"]],template:function(t,n){1&t&&(o.j41(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-title"),o.EFF(3),o.k0s(),o.j41(4,"ion-buttons",2)(5,"ion-button",3),o.bIt("click",function(){return n.close()}),o.nrm(6,"ion-icon",4),o.k0s()()()(),o.j41(7,"ion-content",5)(8,"ion-grid",6)(9,"form",7),o.DNE(10,Yo,21,10,"ng-container",8)(11,Wo,29,25,"ng-container",8)(12,ot,68,13,"ng-container",8),o.k0s()()(),o.j41(13,"ion-footer")(14,"ion-toolbar")(15,"div",9),o.DNE(16,tt,3,1,"div",10)(17,et,3,1,"div",10)(18,nt,3,1,"div",10)(19,it,3,1,"div",10)(20,lt,3,1,"div",10),o.k0s()()()),2&t&&(o.R7$(3),o.SpI("Agregar producto - ",n.pasoActual,""),o.R7$(4),o.Y8G("fullscreen",!0),o.R7$(2),o.Y8G("formGroup",n.formulario),o.R7$(),o.Y8G("ngIf",1==n.estatusDatosbasicos),o.R7$(),o.Y8G("ngIf",1==n.estatusDatosComisiones),o.R7$(),o.Y8G("ngIf",1==n.estatusDatosValidacion),o.R7$(4),o.Y8G("ngIf",1==n.estatusDatosbasicos),o.R7$(),o.Y8G("ngIf",1==n.estatusDatosComisiones),o.R7$(),o.Y8G("ngIf",1==n.estatusDatosComisiones),o.R7$(),o.Y8G("ngIf",1==n.estatusDatosValidacion),o.R7$(),o.Y8G("ngIf",1==n.estatusDatosValidacion))},dependencies:[c.bv,c.Jm,c.QW,c.eY,c.hU,c.W9,c.M0,c.lO,c.eU,c.iq,c.$w,c.ln,c.Nm,c.Ip,c.IO,c.BC,c.ai,c.hB,c.su,c.Je,c.Gw,c.T6,v.X1,v.qT,v.me,v.BC,v.cb,v.j4,v.JD,b.MD,b.Sq,b.bT,Io.M,T.j,T.M,T.c,T.g,z.fS,z.fg,G.X6,G.Vh,G.bZ,G.bU,v.YN],styles:['.inputForm[_ngcontent-%COMP%], .custom-datepicker[_ngcontent-%COMP%], .mat-mdc-form-field[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]     ion-footer .customButton{width:100%;max-width:400px}@media (min-width: 768px){.niveles-2col[_ngcontent-%COMP%]   ion-col[size="12"][_ngcontent-%COMP%]{--ion-grid-column-span: 6}}'],changeDetection:0}),a})();var at=p(6897),st=p(1628),L=p(2490);const ct=()=>[20,50,100];function dt(e,a){if(1&e){const i=o.RV6();o.j41(0,"ion-col",11)(1,"ion-item",12)(2,"ion-label",13),o.EFF(3,"Filtro por grupo"),o.k0s(),o.j41(4,"ionic-selectable",34),o.bIt("onChange",function(n){o.eBV(i);const l=o.XpG();return o.Njj(l.onGrupoSelect(n))})("onClear",function(n){o.eBV(i);const l=o.XpG();return o.Njj(l.onGrupoClear(n))}),o.k0s()()()}if(2&e){const i=o.XpG();o.R7$(4),o.Y8G("items",i.grupos)("canSearch",!0)("canClear",!0)}}function ut(e,a){if(1&e){const i=o.RV6();o.j41(0,"ion-col",11)(1,"ion-item",12)(2,"ion-label",13),o.EFF(3,"Filtro por empresa"),o.k0s(),o.j41(4,"ionic-selectable",35),o.bIt("onChange",function(n){o.eBV(i);const l=o.XpG();return o.Njj(l.onEmpresaSelect(n))})("onClear",function(n){o.eBV(i);const l=o.XpG();return o.Njj(l.onEmpresaClear(n))}),o.k0s()()()}if(2&e){const i=o.XpG();o.R7$(4),o.Y8G("items",i.empresas)("canSearch",!0)("canClear",!0)}}function mt(e,a){1&e&&(o.j41(0,"th",36),o.EFF(1," Nombre/Descripci\xf3n "),o.k0s())}function pt(e,a){if(1&e&&(o.j41(0,"td",37),o.EFF(1),o.k0s()),2&e){const i=a.$implicit;o.R7$(),o.SpI(" ",i.nombre," ")}}function _t(e,a){1&e&&(o.j41(0,"th",36),o.EFF(1," Empresa "),o.k0s())}function gt(e,a){if(1&e&&(o.j41(0,"td",37),o.EFF(1),o.k0s()),2&e){const i=a.$implicit;o.R7$(),o.SpI(" ",i.empresaRazonSocial," ")}}function vt(e,a){1&e&&(o.j41(0,"th",38),o.EFF(1,"Comisi\xf3n"),o.k0s())}function ft(e,a){if(1&e&&(o.j41(0,"td",39),o.EFF(1),o.k0s()),2&e){const i=a.$implicit;o.R7$(),o.SpI(" ",i.comision," ")}}function ht(e,a){1&e&&(o.j41(0,"th",38),o.EFF(1,"Caducidad"),o.k0s())}function Ct(e,a){if(1&e&&(o.j41(0,"td",39),o.EFF(1),o.j41(2,"div")(3,"small",40),o.EFF(4),o.k0s()()()),2&e){const i=a.$implicit,t=o.XpG();o.R7$(),o.SpI(" ",t.formatFecha(i.fechaCaducidad)," "),o.R7$(2),o.Y8G("ngClass",t.getVigencia(i.fechaCaducidad)?"text-success":"text-danger"),o.R7$(),o.SpI(" ",t.getVigencia(i.fechaCaducidad)?"Vigente":"No vigente"," ")}}function Ft(e,a){1&e&&o.nrm(0,"th",41)}function Pt(e,a){if(1&e){const i=o.RV6();o.j41(0,"ion-button",43),o.bIt("click",function(){o.eBV(i);const n=o.XpG().$implicit,l=o.XpG();return o.Njj(l.visualizarModal(n.id))}),o.nrm(1,"ion-icon",44),o.k0s()}}function bt(e,a){if(1&e&&(o.j41(0,"td",39),o.DNE(1,Pt,2,0,"ion-button",42),o.k0s()),2&e){const i=o.XpG();o.R7$(),o.Y8G("ngIf",i.rolUsuario===i.RolesEnum.Admin)}}function xt(e,a){1&e&&o.nrm(0,"tr",45)}function Et(e,a){if(1&e){const i=o.RV6();o.j41(0,"tr",46),o.bIt("dblclick",function(){const n=o.eBV(i).$implicit,l=o.XpG();return o.Njj(l.rolUsuario===l.RolesEnum.Admin&&l.visualizarModal(n.id))})("click",function(){const n=o.eBV(i).$implicit,l=o.XpG();return o.Njj(l.rolUsuario===l.RolesEnum.Socio&&l.verDetalle(n.id))}),o.k0s()}}function kt(e,a){if(1&e&&(o.j41(0,"tr",47)(1,"td",48),o.EFF(2," No se encontraron registros disponibles. "),o.k0s()()),2&e){const i=o.XpG();o.R7$(),o.BMQ("colspan",i.displayedColumns.length)}}const Rt=[{path:"",component:(()=>{var e;class a{constructor(t,n,l,r,s,d){this.productoService=t,this.loadingCtrl=n,this.empresasService=l,this.grupoService=r,this.modalCtrl=s,this.route=d,this.dataSourceTable=new P.I6,this.displayedColumns=[],this.allColumns=["Nombre","Comision","FechaCaducidad"],this.inputBuscar=new X.B,this.query="",this.empresaID=0,this.userid=0,this.inputBusquedaText="Buscar por nombre de producto",this.RolesEnum=x.$u,this.grupos=[],this.empresas=[],this.filterEmpresID=0,this.filterGrupoID=0,this.filterVigencia=0,this.vigencia=[{nombre:"Vigentes",valor:1},{nombre:"No vigentes",valor:2}],this.destroy$=new X.B}ngAfterViewInit(){this.dataSourceTable.sort=this.sort,this.dataSourceTable.paginator=this.paginator,this.dataSourceTable.sortingDataAccessor=(t,n)=>{var l,r,s;if("Comision"===n){const d=this.formatComision(t),u=Number(String(d).replace(/[^\d.-]/g,""));return isNaN(u)?-1/0:u}return"Nombre"===n?null!==(l=null==t?void 0:t.nombre)&&void 0!==l?l:"":"FechaCaducidad"===n?new Date(null!==(r=null==t?void 0:t.fechaCaducidad)&&void 0!==r?r:0).getTime():"Empresa"===n?null!==(s=null==t?void 0:t.empresaRazonSocial)&&void 0!==s?s:"":t[n]}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngOnInit(){var t=this;return(0,E.A)(function*(){var n;const r=t.route.snapshot.data.resolverData.usuario;if(t.rolUsuario=null===(n=r.roles)||void 0===n?void 0:n.enumValue,t.userid=r.id,t.displayedColumns=[...t.allColumns],t.rolUsuario===x.$u.Admin){const g=t.displayedColumns.indexOf("Nombre");-1!==g&&t.displayedColumns.splice(g+1,0,"Empresa"),t.displayedColumns.push("Acciones"),t.inputBusquedaText="Buscar por nombre de producto, empresa o grupo"}const s=yield t.loadingCtrl.create({message:"Cargando datos..."});yield s.present();try{if(t.rolUsuario===x.$u.Socio){var d,u,m;const g=yield(0,k._)(t.empresasService.getAllEmpresasByUsuarioId(t.userid)),f=null!==(d=null==g?void 0:g.data)&&void 0!==d?d:[];if(t.empresaID=Number(null!==(u=null===(m=f[0])||void 0===m?void 0:m.id)&&void 0!==u?u:0),console.log("[Productos] empresaID socio =>",t.empresaID,"lista:",f),!t.empresaID)return console.warn("Usuario socio sin empresa asignada"),t.total=0,void(t.dataSourceTable.data=[])}else{const g=yield(0,k._)(t.empresasService.getAllEmpresas());t.empresas=(null==g?void 0:g.data)||[];const f=yield(0,k._)(t.grupoService.getAllGrupos());t.grupos=(null==f?void 0:f.data)||[]}t.dataSourceTable.paginator=t.paginator,t.loadtable()}catch(g){console.error("Error al cargar datos",g)}finally{s.dismiss()}t.inputBuscar.pipe((0,q.B)(500),(0,H.F)(),(0,Q.Q)(t.destroy$)).subscribe(g=>{t.query=(null!=g?g:"").toString().trim(),t.paginator&&t.paginator.firstPage(),t.loadtable()})})()}loadtable(){switch(this.rolUsuario){case x.$u.Admin:this.loadtableAll();break;case x.$u.Socio:this.loadtableByEmpresa()}}loadtableAll(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),(0,O.h)(this.sort.sortChange,this.paginator.page).pipe((0,Y.Z)({}),(0,N.n)(()=>{var t,n,l,r,s,d,u;return this.productoService.getProductoAllPaginated({page:null!==(t=null===(n=this.paginator)||void 0===n?void 0:n.pageIndex)&&void 0!==t?t:0,size:null!==(l=null===(r=this.paginator)||void 0===r?void 0:r.pageSize)&&void 0!==l?l:50,sortBy:null!==(s=null===(d=this.sort)||void 0===d?void 0:d.active)&&void 0!==s?s:"Nombre",sortDir:(null===(u=this.sort)||void 0===u?void 0:u.direction)||"asc",searchQuery:this.query||"",grupoID:this.filterGrupoID,empresaID:this.filterEmpresID,vigenciaFilter:this.filterVigencia}).pipe((0,j.W)(()=>(0,R.of)(null)))}),(0,y.T)(t=>{var n;if(!t||!1===t.success||!t.data)return this.total=0,[];const{total:l,items:r}=t.data;return this.total=null!=l?l:null!==(n=null==r?void 0:r.length)&&void 0!==n?n:0,null!=r?r:[]})).subscribe(t=>this.dataSourceTable=new P.I6(t))}loadtableByEmpresa(){if(!this.empresaID)return this.total=0,this.dataSourceTable.data=[],void console.warn("[Productos] empresaID vac\xedo.");this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),(0,O.h)(this.sort.sortChange,this.paginator.page).pipe((0,Y.Z)({}),(0,N.n)(()=>{var t,n,l,r,s,d,u;return this.productoService.getProductoByEmpresaPaginated({empresaID:this.empresaID,page:null!==(t=null===(n=this.paginator)||void 0===n?void 0:n.pageIndex)&&void 0!==t?t:0,size:null!==(l=null===(r=this.paginator)||void 0===r?void 0:r.pageSize)&&void 0!==l?l:50,sortBy:null!==(s=null===(d=this.sort)||void 0===d?void 0:d.active)&&void 0!==s?s:"Nombre",sortDir:(null===(u=this.sort)||void 0===u?void 0:u.direction)||"asc",searchQuery:this.query||"",vigenciaFilter:this.filterVigencia}).pipe((0,j.W)(m=>(console.warn("[Productos] paginado ERROR \u2192",m),(0,R.of)({items:[],total:0}))))}),(0,N.n)(({items:t,total:n})=>{var l,r;return 0===(null!=n?n:0)||0===(null!==(l=null==t?void 0:t.length)&&void 0!==l?l:0)?this.productoService.getAllProductosEmpresa(this.empresaID).pipe((0,y.T)(s=>({items:s,total:s.length})),(0,j.W)(s=>(console.warn("[Productos] fallback NO paginado ERROR \u2192",s),(0,R.of)({items:[],total:0})))):(0,R.of)({items:t,total:null!=n?n:null!==(r=null==t?void 0:t.length)&&void 0!==r?r:0})})).subscribe(({items:t,total:n})=>{var l;this.total=null!=n?n:null!==(l=null==t?void 0:t.length)&&void 0!==l?l:0,this.dataSourceTable.data=null!=t?t:[]})}visualizarModal(t){var n=this;return(0,E.A)(function*(){const l=yield n.modalCtrl.create({component:U,cssClass:"modal-empresa modal-empresa--wide",componentProps:{productoId:t}});yield l.present();const{data:r}=yield l.onDidDismiss();r&&n.loadtable()})()}verDetalle(t){var n=this;return(0,E.A)(function*(){yield(yield n.modalCtrl.create({component:U,cssClass:"modal-empresa modal-empresa--wide",componentProps:{productoId:t,readOnly:!0}})).present()})()}addModal(){var t=this;return(0,E.A)(function*(){const n=yield t.modalCtrl.create({component:rt,cssClass:"modal-xl"});yield n.present();const{data:l}=yield n.onDidDismiss();l&&t.loadtable()})()}onGrupoSelect(t){null!=t.value&&null!=t.value&&(this.filterGrupoID=t.value.id,this.loadtable())}onGrupoClear(t){this.filterGrupoID=0,this.loadtable()}onEmpresaSelect(t){null!=t.value&&null!=t.value&&(this.filterEmpresID=t.value.id,this.loadtable())}onEmpresaClear(t){this.filterEmpresID=0,this.loadtable()}onVigenciaSelect(t){null!=t.value&&(this.filterVigencia=t.value.valor,this.loadtable())}onVigenciaClear(t){this.filterVigencia=0,this.loadtable()}formatComision(t){var n,l,r,s,d,u,m,g,f,F;const C=null!==(n=null!==(l=null!==(r=null!==(s=null!==(d=null==t?void 0:t.comision)&&void 0!==d?d:null==t?void 0:t.comisionPorcentaje)&&void 0!==s?s:null==t?void 0:t.porcentaje)&&void 0!==r?r:null==t?void 0:t.nivel_1)&&void 0!==l?l:null==t?void 0:t.nivel1)&&void 0!==n?n:null,h=null!==(u=null!==(m=null!==(g=null==t?void 0:t.monto)&&void 0!==g?g:null==t?void 0:t.montoFijo)&&void 0!==m?m:null==t?void 0:t.comisionMonto)&&void 0!==u?u:null,_=null!==(f=null!==(F=null==t?void 0:t.comisionTipo)&&void 0!==F?F:null==t?void 0:t.tipoComision)&&void 0!==f?f:null!=C?"P":null!=h?"M":null;return"P"===_&&null!=C?`${Number(C)}%`:"M"===_&&null!=h?new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Number(h)):null!=C?`${Number(C)}%`:null!=h?new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(Number(h)):"\u2014"}formatFecha(t){if(null==t)return"No aplica";const n=new Date(t),l=n.getDate().toString().padStart(2,"0");let r=n.toLocaleString("es-MX",{month:"long"});return r=r.charAt(0).toUpperCase()+r.slice(1),`${l} ${r} ${n.getFullYear()}`}getVigencia(t){if(null==t)return!0;const n=new Date;n.setHours(0,0,0,0);const l=new Date(t);return l.setHours(0,0,0,0),l>=n}}return(e=a).\u0275fac=function(t){return new(t||e)(o.rXU(V),o.rXU(c.Xi),o.rXU(J.z),o.rXU(at.b),o.rXU(c.W3),o.rXU(st.nX))},e.\u0275cmp=o.VBU({type:e,selectors:[["app-productos"]],viewQuery:function(t,n){if(1&t&&(o.GBs(D.iy,5),o.GBs(M.B4,5)),2&t){let l;o.mGM(l=o.lsd())&&(n.paginator=l.first),o.mGM(l=o.lsd())&&(n.sort=l.first)}},standalone:!1,decls:53,vars:14,consts:[[1,"pagesHeader"],["slot","start"],["name","archive","color","white"],[1,"pagesContent"],[1,"ion-align-items-center"],["size","12","size-md","9",1,"ion-text-center"],[1,"inputBusqueda",3,"ionInput","placeholder"],["slot","end","name","search","aria-hidden","true"],["size","12","size-md","2",1,"ion-text-center"],["expand","block",1,"customGreenButton",3,"click"],["name","add","color","white"],["size","12","size-md","4",1,"ion-text-center"],[1,"inputBusqueda"],["position","floating"],["item-content","","itemValueField","valor","itemTextField","nombre","closeButtonSlot","end","closeButtonText","Cancelar","clearButtonText","Limpiar",3,"onChange","onClear","items","canSearch","canClear"],["size","12","size-md","4","class","ion-text-center",4,"ngIf"],[1,"referidosHeader"],[1,"title"],[2,"overflow-x","auto"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","Nombre"],["mat-header-cell","","style","padding-left: 1rem;","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","style","padding-left: 1rem;",4,"matCellDef"],["matColumnDef","Empresa"],["matColumnDef","Comision"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","FechaCaducidad"],["matColumnDef","Acciones"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","mydivoutermulti elemento-renglon row_clickable",3,"dblclick","click",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"length","pageSizeOptions","pageSize"],["item-content","","itemValueField","id","itemTextField","nombre","closeButtonSlot","end","closeButtonText","Cancelar","clearButtonText","Limpiar",3,"onChange","onClear","items","canSearch","canClear"],["item-content","","itemValueField","id","itemTextField","razonSocial","closeButtonSlot","end","closeButtonText","Cancelar","clearButtonText","Limpiar",3,"onChange","onClear","items","canSearch","canClear"],["mat-header-cell","","mat-sort-header","",2,"padding-left","1rem"],["mat-cell","",2,"padding-left","1rem"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[3,"ngClass"],["mat-header-cell",""],["fill","clear","size","small",3,"click",4,"ngIf"],["fill","clear","size","small",3,"click"],["slot","icon-only","name","create-outline"],["mat-header-row",""],["mat-row","",1,"mydivoutermulti","elemento-renglon","row_clickable",3,"dblclick","click"],[1,"mat-row"],[2,"text-align","center","padding","1rem"]],template:function(t,n){1&t&&(o.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),o.nrm(3,"ion-menu-button"),o.k0s(),o.j41(4,"ion-title")(5,"h1"),o.nrm(6,"ion-icon",2),o.EFF(7," Productos a promocionar"),o.k0s()()()(),o.j41(8,"ion-content",3)(9,"div")(10,"ion-grid")(11,"ion-row",4)(12,"ion-col",5)(13,"ion-input",6),o.bIt("ionInput",function(r){return n.inputBuscar.next(r.detail.value||"")}),o.nrm(14,"ion-icon",7),o.k0s()(),o.j41(15,"ion-col",8)(16,"ion-button",9),o.bIt("click",function(){return n.addModal()}),o.nrm(17,"ion-icon",10),o.EFF(18," AGREGAR "),o.k0s()()(),o.j41(19,"ion-row",4)(20,"ion-col",11)(21,"ion-item",12)(22,"ion-label",13),o.EFF(23,"Filtro por vigencia"),o.k0s(),o.j41(24,"ionic-selectable",14),o.bIt("onChange",function(r){return n.onVigenciaSelect(r)})("onClear",function(r){return n.onVigenciaClear(r)}),o.k0s()()(),o.DNE(25,dt,5,3,"ion-col",15)(26,ut,5,3,"ion-col",15),o.k0s()()(),o.j41(27,"ion-card")(28,"ion-card-header",16)(29,"ion-card-title",17),o.EFF(30,"Productos"),o.k0s()(),o.j41(31,"ion-card-content")(32,"div",18)(33,"table",19),o.qex(34,20),o.DNE(35,mt,2,0,"th",21)(36,pt,2,1,"td",22),o.bVm(),o.qex(37,23),o.DNE(38,_t,2,0,"th",21)(39,gt,2,1,"td",22),o.bVm(),o.qex(40,24),o.DNE(41,vt,2,0,"th",25)(42,ft,2,1,"td",26),o.bVm(),o.qex(43,27),o.DNE(44,ht,2,0,"th",25)(45,Ct,5,3,"td",26),o.bVm(),o.qex(46,28),o.DNE(47,Ft,1,0,"th",29)(48,bt,2,1,"td",26),o.bVm(),o.DNE(49,xt,1,0,"tr",30)(50,Et,1,0,"tr",31)(51,kt,3,1,"tr",32),o.k0s()(),o.nrm(52,"mat-paginator",33),o.k0s()()()),2&t&&(o.R7$(13),o.Y8G("placeholder",n.inputBusquedaText),o.R7$(11),o.Y8G("items",n.vigencia)("canSearch",!0)("canClear",!0),o.R7$(),o.Y8G("ngIf",n.rolUsuario==n.RolesEnum.Admin),o.R7$(),o.Y8G("ngIf",n.rolUsuario==n.RolesEnum.Admin),o.R7$(7),o.Y8G("dataSource",n.dataSourceTable),o.R7$(16),o.Y8G("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),o.R7$(),o.Y8G("matRowDefColumns",n.displayedColumns),o.R7$(2),o.Y8G("length",n.total)("pageSizeOptions",o.lJ4(13,ct))("pageSize",50))},dependencies:[b.YU,b.bT,c.Jm,c.QW,c.b_,c.I9,c.ME,c.tN,c.hU,c.W9,c.lO,c.eU,c.iq,c.$w,c.uz,c.he,c.MC,c.ln,c.BC,c.ai,c.Gw,P.Zl,P.tL,P.ji,P.cC,P.YV,P.iL,P.KS,P.$R,P.YZ,P.NB,P.ky,D.iy,M.B4,M.aE,L.ec],styles:[".text-success[_ngcontent-%COMP%]{color:green}.text-danger[_ngcontent-%COMP%]{color:red}"]}),a})()}];let $t=(()=>{var e;class a{}return(e=a).\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.$C({type:e}),e.\u0275inj=o.G2t({imports:[B.iI.forChild(Rt),B.iI]}),a})(),jt=(()=>{var e;class a{}return(e=a).\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.$C({type:e}),e.\u0275inj=o.G2t({imports:[b.MD,v.YN,c.bv,$t,P.tP,D.Ou,M.NQ,L.ec]}),a})()}}]);