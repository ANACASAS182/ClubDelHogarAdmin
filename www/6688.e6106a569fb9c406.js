"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6688],{4843:(b,c,i)=>{i.d(c,{_:()=>d});var m=i(9350),s=i(7707);function d(p,f){const v="object"==typeof f;return new Promise((h,o)=>{const E=new s.Ms({next:P=>{h(P),E.unsubscribe()},error:o,complete:()=>{v?h(f.defaultValue):o(new m.G)}});p.subscribe(E)})}},6688:(b,c,i)=>{i.r(c),i.d(c,{LoginPageModule:()=>I});var m=i(2881),s=i(9417),d=i(3092),p=i(9870),f=i(467),v=i(4843),h=i(980),o=i(1360),E=i(2101),P=i(7248),x=i(2091);function L(n,u){if(1&n&&(o.j41(0,"div",5)(1,"ion-text"),o.EFF(2),o.k0s()()),2&n){const g=o.XpG(2);o.R7$(2),o.JRh(g.messageError)}}function F(n,u){if(1&n&&o.DNE(0,L,3,1,"div",11),2&n){const g=o.XpG();o.Y8G("ngIf",g.hasError)}}function _(n,u){1&n&&(o.j41(0,"ion-text",12),o.EFF(1," Ingresa un email v\xe1lido. "),o.k0s())}function M(n,u){1&n&&(o.j41(0,"ion-text",12),o.EFF(1," Ingrese su contrase\xf1a. "),o.k0s())}const w=[{path:"",component:(()=>{var n;class u{constructor(e,r,a,t,l){this.fb=e,this.router=r,this.usuarioService=a,this.toastController=t,this.tokenService=l,this.hasError=!1,this.messageError="",this.formEnviado=!1,this.loginForm=this.fb.group({user:["",[s.k0.required,s.k0.email]],password:["",s.k0.required]})}ngOnInit(){}onSubmit(){var e=this;return(0,f.A)(function*(){if(e.formEnviado)return;if(e.formEnviado=!0,!e.loginForm.valid)return e.loginForm.markAllAsTouched(),void(e.formEnviado=!1);const r={email:e.loginForm.controls.user.value,password:e.loginForm.controls.password.value};try{const t=yield(0,v._)(e.usuarioService.login(r,!0).pipe((0,h.j)(()=>e.formEnviado=!1)));if(null==t||!t.success||null==t||!t.data)return e.hasError=!0,void(e.messageError=(null==t?void 0:t.message)||"No se pudo iniciar sesi\xf3n.");yield e.tokenService.saveToken(t.data);try{const l=yield(0,v._)(e.usuarioService.getUsuario(!0));null!=l&&l.success&&null!=l&&l.data?localStorage.setItem("usuario-actual",JSON.stringify(l.data)):localStorage.removeItem("usuario-actual")}catch{localStorage.removeItem("usuario-actual")}yield e.router.navigate(["/dashboard"],{replaceUrl:!0})}catch(t){var a;e.hasError=!0,e.messageError=(null==t||null===(a=t.error)||void 0===a?void 0:a.message)||"Error al iniciar sesi\xf3n. Intenta de nuevo."}})()}getControl(e){return this.loginForm.get(e)}}return(n=u).\u0275fac=function(e){return new(e||n)(o.rXU(s.ok),o.rXU(E.Ix),o.rXU(P.o),o.rXU(d.K_),o.rXU(x.B))},n.\u0275cmp=o.VBU({type:n,selectors:[["app-login"]],standalone:!1,decls:14,vars:9,consts:[["fullscreen","",1,"login-page"],[1,"center-wrapper"],[1,"login-card",3,"formGroup"],["src","assets/logo.png","alt","Logo",1,"logo"],[1,"form-title"],[1,"custom-alert","warning"],["autocomplete","username","formControlName","user","placeholder","Usuario (Correo de contacto)","type","text",1,"input",3,"ionBlur"],["color","danger",4,"ngIf"],["autocomplete","current-password","formControlName","password","placeholder","Contrase\xf1a","type","password",1,"input",3,"ionBlur"],["slot","end"],["expand","block",1,"login-button",3,"click","disabled"],["class","custom-alert warning",4,"ngIf"],["color","danger"]],template:function(e,r){if(1&e&&(o.j41(0,"ion-content",0)(1,"div",1)(2,"div",2),o.nrm(3,"img",3),o.j41(4,"h2",4),o.EFF(5,"Inicia Sesi\xf3n"),o.k0s(),o.DNE(6,F,1,1,"div",5),o.j41(7,"ion-input",6),o.bIt("ionBlur",function(){let t;return null==(t=r.getControl("user"))?null:t.markAsTouched()}),o.k0s(),o.DNE(8,_,2,0,"ion-text",7),o.j41(9,"ion-input",8),o.bIt("ionBlur",function(){let t;return null==(t=r.getControl("password"))?null:t.markAsTouched()}),o.nrm(10,"ion-input-password-toggle",9),o.k0s(),o.DNE(11,M,2,0,"ion-text",7),o.j41(12,"ion-button",10),o.bIt("click",function(){return r.onSubmit()}),o.EFF(13,"ENTRAR"),o.k0s()()()()),2&e){let a,t,l,C;o.R7$(2),o.Y8G("formGroup",r.loginForm),o.R7$(4),o.vxM(r.hasError?6:-1),o.R7$(),o.AVh("invalid",(null==(a=r.getControl("user"))?null:a.invalid)&&(null==(a=r.getControl("user"))?null:a.touched)),o.R7$(),o.Y8G("ngIf",(null==(t=r.getControl("user"))?null:t.invalid)&&(null==(t=r.getControl("user"))?null:t.touched)),o.R7$(),o.AVh("invalid",(null==(l=r.getControl("password"))?null:l.invalid)&&(null==(l=r.getControl("password"))?null:l.touched)),o.R7$(2),o.Y8G("ngIf",(null==(C=r.getControl("password"))?null:C.invalid)&&(null==(C=r.getControl("password"))?null:C.touched)),o.R7$(),o.Y8G("disabled",r.formEnviado)}},dependencies:[m.bT,s.BC,s.cb,d.Jm,d.W9,d.$w,d.Wv,d.IO,d.Gw,s.j4,s.JD],styles:[".login-page[_ngcontent-%COMP%]{--background: #ffffff;height:100%}.center-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%;width:100%}.login-card[_ngcontent-%COMP%]{position:relative;background:#fff;border-radius:20px;width:90%;max-width:500px;padding:40px 20px 100px;box-shadow:0 4px 12px #0000001a;text-align:center;overflow:hidden;display:flex;flex-direction:column;align-items:center}.form-title[_ngcontent-%COMP%]{font-weight:700;color:#2c3e50;margin-bottom:20px}.input[_ngcontent-%COMP%]{margin:12px 0;--background: #f1f1f1;--border-radius: 30px;--padding-start: 16px;--padding-end: 16px;width:100%;color:#2c3e50!important;border:1px solid transparent;border-radius:30px;border-color:#000;transition:border-color .3s ease}.input.invalid[_ngcontent-%COMP%]{border-color:var(--ion-color-danger, red)}.login-button[_ngcontent-%COMP%]{--background: #0d3b66;font-weight:700;color:#fff}"]}),u})()}];let y=(()=>{var n;class u{}return(n=u).\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.$C({type:n}),n.\u0275inj=o.G2t({imports:[p.iI.forChild(w),p.iI]}),u})(),I=(()=>{var n;class u{}return(n=u).\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.$C({type:n}),n.\u0275inj=o.G2t({imports:[m.MD,s.YN,d.bv,y,s.X1]}),u})()}}]);