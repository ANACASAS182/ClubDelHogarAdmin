"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7273],{7273:(T,m,c)=>{c.r(m),c.d(m,{CelulasPageModule:()=>G});var g=c(2881),M=c(9417),u=c(3092),x=c(9870),e=c(1360),P=c(7248);const N=["svgRef"];function R(s,i){if(1&s){const t=e.RV6();e.qSk(),e.j41(0,"g",6),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.nivelSuperior(0))}),e.nrm(1,"rect",11),e.j41(2,"text",8),e.EFF(3,"\u{1f3e0}"),e.k0s()()}if(2&s){const t=e.XpG();e.R7$(),e.BMQ("x",t.baseNode.x-80)("y",t.baseNode.y),e.R7$(),e.BMQ("x",t.baseNode.x-80)("y",t.baseNode.y+20)}}function $(s,i){if(1&s){const t=e.RV6();e.qSk(),e.j41(0,"g",6),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.nivelSuperior(n.baseNode.parentId))}),e.nrm(1,"rect",11),e.j41(2,"text",8),e.EFF(3,"\u2b06\ufe0f"),e.k0s()()}if(2&s){const t=e.XpG();e.R7$(),e.BMQ("x",t.baseNode.x-40)("y",t.baseNode.y),e.R7$(),e.BMQ("x",t.baseNode.x-40)("y",t.baseNode.y+20)}}function k(s,i){if(1&s&&(e.qSk(),e.nrm(0,"path",15)),2&s){const t=e.XpG().$implicit;e.BMQ("d",t.ruta)}}function B(s,i){if(1&s&&(e.qSk(),e.nrm(0,"line",16)),2&s){const t=e.XpG().$implicit;e.BMQ("x1",t.x-90)("y1",t.y+30)("x2",t.x)("y2",t.y+30)}}function F(s,i){if(1&s&&(e.qSk(),e.j41(0,"text",20),e.EFF(1),e.k0s()),2&s){const t=i.$implicit,o=i.index,n=e.XpG(2).$implicit,a=e.XpG();e.BMQ("x",n.x+a.nodeTextLeftPadding+160)("y",n.y+25*(1+o)+70),e.R7$(),e.JRh(t)}}function I(s,i){if(1&s&&(e.qSk(),e.qex(0),e.j41(1,"g",17),e.nrm(2,"rect",18),e.DNE(3,F,2,3,"text",19),e.k0s(),e.bVm()),2&s){const t=e.XpG().$implicit;e.R7$(2),e.BMQ("x",t.x+160)("y",t.y+70),e.R7$(),e.Y8G("ngForOf",t.children)}}function j(s,i){if(1&s){const t=e.RV6();e.qSk(),e.j41(0,"g",6),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.onRectClick(n.usuarioId))}),e.nrm(1,"rect",7),e.j41(2,"text",8),e.EFF(3),e.k0s(),e.j41(4,"text",9),e.EFF(5),e.k0s(),e.DNE(6,k,1,1,"path",12)(7,B,1,4,"line",13)(8,I,4,3,"ng-container",14),e.k0s()}if(2&s){const t=i.$implicit,o=e.XpG();e.R7$(),e.BMQ("x",t.x)("y",t.y),e.R7$(),e.BMQ("x",t.x+o.nodeTextLeftPadding)("y",t.y+25),e.R7$(),e.JRh(t.nombre),e.R7$(),e.BMQ("x",t.x+o.nodeTextLeftPadding)("y",t.y+40),e.R7$(),e.JRh(t.contacto),e.R7$(),e.Y8G("ngIf",t.parent&&0==t.nivel),e.R7$(),e.Y8G("ngIf",t.parent&&1==t.nivel),e.R7$(),e.Y8G("ngIf",t.nivel>0&&t.children.length>0)}}let S=(()=>{var s;class i{constructor(o){this.usuarioSerivice=o,this.scale=1,this.panX=0,this.panY=0,this.transform="translate(0,0) scale(1)",this.isPanning=!1,this.startX=0,this.startY=0,this.precalculatedNodes=[],this.precalculatedNodesReversed=[],this.xBase=100,this.yBase=40,this.nodeTextLeftPadding=16,this.xSemiStep=20,this.ySemiStep=20,this.xStep=260,this.yStep=100,this.onMouseDown=n=>{this.isPanning=!0,this.startX=n.clientX,this.startY=n.clientY},this.onMouseMove=n=>{this.isPanning&&(this.panX+=n.clientX-this.startX,this.panY+=n.clientY-this.startY,this.startX=n.clientX,this.startY=n.clientY,this.updateTransform())},this.onMouseUp=()=>{this.isPanning=!1},this.onWheel=n=>{n.preventDefault(),this.scale*=1+.1*(n.deltaY<0?1:-1),this.updateTransform()},this.baseNode=new p,this.baseNode.nombre="Embassy",this.baseNode.contacto="",this.baseNode.x=this.xBase,this.baseNode.y=this.yBase}nivelSuperior(o){this.loadDataCelula(o)}loadDataCelula(o){this.precalculatedNodes=[],this.panX=0,this.panY=0,this.usuarioSerivice.getCelulaFromHere(o).subscribe({next:n=>{var a,h;console.log(n),this.baseNode=n.nivel1,this.baseNode.parentId=null===(a=n.nivel1)||void 0===a?void 0:a.parentId,this.baseNode.x=this.xBase,this.baseNode.y=this.yBase;let C=1;null===(h=n.nivel2)||void 0===h||h.forEach(_=>{var v;let r=new p;r.usuarioId=_.usuarioId,r.nombre=_.nombre,r.contacto=_.contacto,r.x=this.xBase+this.xSemiStep,r.y=this.yBase+this.yStep*C,r.parent=this.baseNode,this.precalculatedNodes.push(r);let y=1;null===(v=n.nivel3)||void 0===v||v.forEach(d=>{if(d.parentId==r.usuarioId){var f;let l=new p;l.usuarioId=d.usuarioId,l.parent=r,l.nombre=d.nombre,l.contacto=d.contacto,l.x=this.xBase+this.xStep*y,l.y=l.parent.y+this.ySemiStep,l.nivel=1;let O=1;l.children=[],null===(f=n.nivel4)||void 0===f||f.forEach(b=>{b.parentId==l.usuarioId&&(l.children.push(b.nombre),O++)}),y++,this.precalculatedNodes.push(l)}}),C++}),this.precalculatedNodesReversed=this.precalculatedNodes.slice().reverse()}})}ngOnInit(){const o=this.svgRef.nativeElement;this.loadDataCelula(0),o.addEventListener("mousedown",this.onMouseDown),o.addEventListener("mousemove",this.onMouseMove),o.addEventListener("mouseup",this.onMouseUp),o.addEventListener("mouseleave",this.onMouseUp),o.addEventListener("wheel",this.onWheel,{passive:!1})}onRectClick(o){this.loadDataCelula(o)}updateTransform(){this.transform=`translate(${this.panX}, ${this.panY}) scale(${this.scale})`}}return(s=i).\u0275fac=function(o){return new(o||s)(e.rXU(P.o))},s.\u0275cmp=e.VBU({type:s,selectors:[["app-celulas"]],viewQuery:function(o,n){if(1&o&&e.GBs(N,7),2&o){let a;e.mGM(a=e.lsd())&&(n.svgRef=a.first)}},standalone:!1,decls:21,vars:12,consts:[["svgRef",""],[1,"pagesHeader"],["slot","start"],["name","grid","color","white"],[1,"org-svg"],["class","hover-group",3,"click",4,"ngIf"],[1,"hover-group",3,"click"],["width","180","height","60","fill","#4CAF50","rx","4","ry","4",1,"zoomable"],["font-size","18","text-anchor","start","fill","white",1,"contenido"],["font-size","12","text-anchor","start","fill","white",1,"contenidoContacto"],["class","hover-group",3,"click",4,"ngFor","ngForOf"],["width","30","height","30","fill","#4CAF50","rx","4","ry","4",1,"hoverable"],["stroke-width","2","stroke","#444","fill","none",4,"ngIf"],["stroke","#444","stroke-width","2",4,"ngIf"],[4,"ngIf"],["stroke-width","2","stroke","#444","fill","none"],["stroke","#444","stroke-width","2"],[1,"hover-subgroup"],["width","20","height","20","fill","#4CAF50","rx","4","ry","4",1,"expandible"],["font-size","14","text-anchor","start","fill","white","class","subcontenido",4,"ngFor","ngForOf"],["font-size","14","text-anchor","start","fill","white",1,"subcontenido"]],template:function(o,n){if(1&o){const a=e.RV6();e.j41(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-buttons",2),e.nrm(3,"ion-menu-button"),e.k0s(),e.j41(4,"ion-title")(5,"h1"),e.nrm(6,"ion-icon",3),e.EFF(7," C\xe9lulas"),e.k0s()()()(),e.j41(8,"ion-content"),e.qSk(),e.j41(9,"svg",4,0)(11,"g"),e.DNE(12,R,4,4,"g",5)(13,$,4,4,"g",5),e.j41(14,"g",6),e.bIt("click",function(){return e.eBV(a),e.Njj(n.onRectClick(0))}),e.nrm(15,"rect",7),e.j41(16,"text",8),e.EFF(17),e.k0s(),e.j41(18,"text",9),e.EFF(19),e.k0s()(),e.DNE(20,j,9,11,"g",10),e.k0s()()()}2&o&&(e.R7$(11),e.BMQ("transform",n.transform),e.R7$(),e.Y8G("ngIf",0!=n.baseNode.usuarioId),e.R7$(),e.Y8G("ngIf",n.baseNode.parentId>0),e.R7$(2),e.BMQ("x",n.baseNode.x)("y",n.baseNode.y),e.R7$(),e.BMQ("x",n.baseNode.x+n.nodeTextLeftPadding)("y",n.baseNode.y+25),e.R7$(),e.JRh(n.baseNode.nombre),e.R7$(),e.BMQ("x",n.baseNode.x+n.nodeTextLeftPadding)("y",n.baseNode.y+40),e.R7$(),e.JRh(n.baseNode.contacto),e.R7$(),e.Y8G("ngForOf",n.precalculatedNodesReversed))},dependencies:[g.Sq,g.bT,u.QW,u.W9,u.eU,u.iq,u.MC,u.BC,u.ai],styles:[".org-svg[_ngcontent-%COMP%]{width:100vw;height:100vh;background:#f0f0f0;cursor:grab;-webkit-user-select:none;user-select:none}",".contenido[_ngcontent-%COMP%]{opacity:.5;transition:opacity .3s ease;pointer-events:none}.contenidoContacto[_ngcontent-%COMP%], .subcontenido[_ngcontent-%COMP%]{opacity:0;transition:opacity .3s ease;pointer-events:none}.hover-group[_ngcontent-%COMP%]:hover   .contenido[_ngcontent-%COMP%], .hover-group[_ngcontent-%COMP%]:hover   .contenidoContacto[_ngcontent-%COMP%], .hover-subgroup[_ngcontent-%COMP%]:hover   .subcontenido[_ngcontent-%COMP%]{opacity:1}.zoomable[_ngcontent-%COMP%]{transition:all .3s ease}.hover-group[_ngcontent-%COMP%]:hover   .zoomable[_ngcontent-%COMP%]{width:240px;cursor:pointer!important;fill:#023f3c}.hoverable[_ngcontent-%COMP%]{transition:all .3s ease}.hover-group[_ngcontent-%COMP%]:hover   .hoverable[_ngcontent-%COMP%]{cursor:pointer!important;fill:#023f3c}.expandible[_ngcontent-%COMP%]{transition:all .3s ease}.expandible[_ngcontent-%COMP%]:hover{width:240px;height:240px;fill:#023f3c;cursor:pointer!important}"]}),i})();class p{constructor(){this.usuarioId=0,this.nombre="",this.contacto="",this.parentId=0,this.parentNombre="",this.nivel=0,this.x=0,this.y=0}get ruta(){return`M ${this.parent.x+10} ${this.parent.y+60} C ${this.parent.x+10} ${this.y+30}, ${this.parent.x+10} ${this.y+30}, ${this.x} ${this.y+30}`}}const E=[{path:"",component:S}];let w=(()=>{var s;class i{}return(s=i).\u0275fac=function(o){return new(o||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[x.iI.forChild(E),x.iI]}),i})(),G=(()=>{var s;class i{}return(s=i).\u0275fac=function(o){return new(o||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[g.MD,M.YN,u.bv,w]}),i})()}}]);