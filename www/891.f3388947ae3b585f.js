"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[891],{891:(X,b,i)=>{i.r(b),i.d(b,{PasswordResetModule:()=>N});var _=i(2881),l=i(9417),x=i(9870),P=i(7786),k=i(980),t=i(1360),w=i(1628),M=i(7248);function C(e,r){if(1&e&&(t.j41(0,"div",10),t.EFF(1),t.k0s()),2&e){const o=t.XpG();t.R7$(),t.JRh(o.errorMsg)}}function R(e,r){if(1&e&&(t.j41(0,"div",11),t.EFF(1),t.k0s()),2&e){const o=t.XpG();t.R7$(),t.JRh(o.okMsg)}}function $(e,r){1&e&&(t.qSk(),t.j41(0,"svg",22),t.nrm(1,"path",23),t.k0s())}function F(e,r){1&e&&(t.qSk(),t.j41(0,"svg",22),t.nrm(1,"path",24),t.k0s())}function y(e,r){1&e&&(t.j41(0,"small",25),t.EFF(1," La contrase\xf1a debe tener al menos 6 caracteres. "),t.k0s())}function j(e,r){1&e&&(t.qSk(),t.j41(0,"svg",22),t.nrm(1,"path",23),t.k0s())}function O(e,r){1&e&&(t.qSk(),t.j41(0,"svg",22),t.nrm(1,"path",24),t.k0s())}function T(e,r){1&e&&(t.j41(0,"small",25),t.EFF(1," Campo requerido. "),t.k0s())}function G(e,r){if(1&e){const o=t.RV6();t.j41(0,"form",12),t.bIt("ngSubmit",function(){t.eBV(o);const s=t.XpG();return t.Njj(s.submit())}),t.j41(1,"label",13),t.EFF(2,"Nueva contrase\xf1a"),t.k0s(),t.j41(3,"div",14)(4,"input",15),t.bIt("input",function(){t.eBV(o);const s=t.XpG();return t.Njj(s.checkStrength())}),t.k0s(),t.j41(5,"button",16),t.bIt("click",function(){t.eBV(o);const s=t.XpG();return t.Njj(s.togglePass())}),t.DNE(6,$,2,0,"svg",17)(7,F,2,0,"svg",17),t.k0s()(),t.DNE(8,y,2,0,"small",18),t.j41(9,"label",13),t.EFF(10,"Confirmar nueva contrase\xf1a"),t.k0s(),t.j41(11,"div",14),t.nrm(12,"input",19),t.j41(13,"button",16),t.bIt("click",function(){t.eBV(o);const s=t.XpG();return t.Njj(s.toggleConfirm())}),t.DNE(14,j,2,0,"svg",17)(15,O,2,0,"svg",17),t.k0s()(),t.DNE(16,T,2,0,"small",18),t.j41(17,"button",20),t.EFF(18,"Cambiar contrase\xf1a"),t.k0s(),t.j41(19,"p",21),t.EFF(20,"El enlace expira tras unas horas por seguridad."),t.k0s()()}if(2&e){const o=t.XpG();t.Y8G("formGroup",o.form),t.R7$(4),t.Y8G("type",o.showPass?"text":"password"),t.R7$(),t.BMQ("aria-label",o.showPass?"Ocultar contrase\xf1a":"Mostrar contrase\xf1a"),t.R7$(),t.Y8G("ngIf",!o.showPass),t.R7$(),t.Y8G("ngIf",o.showPass),t.R7$(),t.Y8G("ngIf",o.form.controls.password.touched&&o.form.controls.password.errors),t.R7$(4),t.Y8G("type",o.showConfirm?"text":"password"),t.R7$(),t.BMQ("aria-label",o.showConfirm?"Ocultar contrase\xf1a":"Mostrar contrase\xf1a"),t.R7$(),t.Y8G("ngIf",!o.showConfirm),t.R7$(),t.Y8G("ngIf",o.showConfirm),t.R7$(),t.Y8G("ngIf",o.form.controls.confirmPassword.touched&&o.form.controls.confirmPassword.errors),t.R7$(),t.Y8G("disabled",o.loading)}}function I(e,r){1&e&&(t.j41(0,"div",26)(1,"h3",27),t.EFF(2,"\xa1Contrase\xf1a actualizada!"),t.k0s(),t.j41(3,"p",28),t.EFF(4," Recuerda descargar nuestra app para aprovechar al m\xe1ximo todas las funcionalidades. "),t.k0s(),t.j41(5,"div",29)(6,"a",30),t.nrm(7,"img",31),t.k0s(),t.j41(8,"a",32),t.nrm(9,"img",33),t.k0s()()())}function E(e,r){1&e&&(t.j41(0,"div",34),t.EFF(1," Si necesitas otro enlace, solicita nuevamente el cambio de contrase\xf1a. "),t.k0s())}let S=(()=>{var e;class r{constructor(n,s,d,a){this.fb=n,this.route=s,this.router=d,this.usuarioService=a,this.token="",this.loading=!1,this.errorMsg="",this.okMsg="",this.showPass=!1,this.showConfirm=!1,this.validToken=!1,this.showDownload=!1,this.strengthVal=0,this.strengthState="weak",this.strengthText="D\xe9bil",this.form=this.fb.group({password:["",[l.k0.required,l.k0.minLength(6)]],confirmPassword:["",[l.k0.required]]}),this.sub=(0,P.h)(...this.route.parent?[this.route.paramMap,this.route.parent.paramMap]:[this.route.paramMap]).subscribe(()=>{var u,c,p;const g=this.route.snapshot.paramMap.get("token"),z=null!==(u=null===(c=this.route.parent)||void 0===c?void 0:c.snapshot.paramMap.get("token"))&&void 0!==u?u:null;if(this.token=null!==(p=null!=g?g:z)&&void 0!==p?p:"",!this.token)return this.errorMsg="Token no proporcionado.",void(this.validToken=!1);this.usuarioService.passwordRecoveryVerify(this.token).subscribe({next:()=>{this.validToken=!0},error:h=>{var m,v;this.validToken=!1,this.errorMsg=null!==(m=null==h||null===(v=h.error)||void 0===v?void 0:v.message)&&void 0!==m?m:"El enlace ya no es v\xe1lido."}})})}ngOnDestroy(){var n;null===(n=this.sub)||void 0===n||n.unsubscribe()}togglePass(){this.showPass=!this.showPass}toggleConfirm(){this.showConfirm=!this.showConfirm}checkStrength(){var n,s;const d=null!==(n=null===(s=this.form.get("password"))||void 0===s?void 0:s.value)&&void 0!==n?n:"";let a=0;d.length>=6&&a++,/[A-Z]/.test(d)&&a++,/[0-9]/.test(d)&&a++,/[^A-Za-z0-9]/.test(d)&&a++,d.length>=10&&a++,a<=2?(this.strengthVal=25,this.strengthState="weak",this.strengthText="D\xe9bil"):3===a||4===a?(this.strengthVal=55,this.strengthState="medium",this.strengthText="Media"):(this.strengthVal=100,this.strengthState="strong",this.strengthText="Fuerte")}submit(){var n,s,d,a;if(this.errorMsg="",this.form.invalid||!this.token)return this.form.markAllAsTouched(),void(this.token||(this.errorMsg="Token no proporcionado."));const f=null!==(n=null===(s=this.form.get("password"))||void 0===s?void 0:s.value)&&void 0!==n?n:"",u=null!==(d=null===(a=this.form.get("confirmPassword"))||void 0===a?void 0:a.value)&&void 0!==d?d:"";f===u?(this.loading=!0,this.usuarioService.passwordReset({newPassword:f,confirmNewPassword:u,token:this.token},!1).pipe((0,k.j)(()=>this.loading=!1)).subscribe({next:()=>{this.okMsg="Contrase\xf1a actualizada con \xe9xito.",this.showDownload=!0,this.validToken=!1,this.form.reset();try{window.scrollTo({top:0,behavior:"smooth"})}catch{}},error:c=>{var p,g;this.errorMsg=null!==(p=null==c||null===(g=c.error)||void 0===g?void 0:g.message)&&void 0!==p?p:"No se pudo actualizar la contrase\xf1a."}})):this.errorMsg="Las contrase\xf1as no coinciden."}goLogin(){this.router.navigateByUrl("/login")}}return(e=r).\u0275fac=function(n){return new(n||e)(t.rXU(l.ok),t.rXU(w.nX),t.rXU(w.Ix),t.rXU(M.o))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-password-reset"]],standalone:!1,decls:12,vars:5,consts:[[1,"reset-wrapper"],[1,"reset-card"],["src","/assets/logo_transparente.png","alt","Embassy",1,"logo"],[1,"title"],[1,"subtitle"],["class","alert warn",4,"ngIf"],["class","alert ok",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],["class","download-block",4,"ngIf"],["class","info",4,"ngIf"],[1,"alert","warn"],[1,"alert","ok"],[3,"ngSubmit","formGroup"],[1,"label"],[1,"input-wrap"],["formControlName","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"input",3,"input","type"],["type","button",1,"eye-btn",3,"click"],["viewBox","0 0 24 24","aria-hidden","true",4,"ngIf"],["class","hint error",4,"ngIf"],["formControlName","confirmPassword","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"input",3,"type"],["type","submit",1,"btn",3,"disabled"],[1,"footnote"],["viewBox","0 0 24 24","aria-hidden","true"],["d","M12 5C5 5 2 12 2 12s3 7 10 7 10-7 10-7-3-7-10-7Zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10Z"],["d","M3.3 2 2 3.3 5.2 6.6C3.1 8 2 10 2 12c0 0 3 7 10 7 2 0 3.8-.6 5.4-1.5l1.7 1.7 1.3-1.3L3.3 2Zm7.6 9.2a3.5 3.5 0 0 0 4 4l-4-4Zm1-5.2c7 0 10 7 10 7a14.6 14.6 0 0 1-4.3 5.1l-1.5-1.5A12.3 12.3 0 0 0 22 12s-3-7-10-7c-.8 0-1.6.1-2.3.3l1.2 1.2c.4 0 .7-.1 1.1-.1Z"],[1,"hint","error"],[1,"download-block"],[1,"download-title"],[1,"download-subtitle"],[1,"app-links"],["href","https://play.google.com/store/apps/details?id=com.embassybusiness.app","target","_blank","rel","noopener"],["src","https://upload.wikimedia.org/wikipedia/commons/7/78/Google_Play_Store_badge_EN.svg","alt","Google Play"],["href","https://apps.apple.com/mx/app/embassy/id6747898144","target","_blank","rel","noopener"],["src","https://developer.apple.com/assets/elements/badges/download-on-the-app-store.svg","alt","App Store"],[1,"info"]],template:function(n,s){1&n&&(t.j41(0,"div",0)(1,"div",1),t.nrm(2,"img",2),t.j41(3,"h2",3),t.EFF(4,"Restablecer contrase\xf1a"),t.k0s(),t.j41(5,"p",4),t.EFF(6,"Crea una nueva contrase\xf1a para tu cuenta."),t.k0s(),t.DNE(7,C,2,1,"div",5)(8,R,2,1,"div",6)(9,G,21,12,"form",7)(10,I,10,0,"div",8)(11,E,2,0,"div",9),t.k0s()()),2&n&&(t.R7$(7),t.Y8G("ngIf",s.errorMsg),t.R7$(),t.Y8G("ngIf",s.okMsg),t.R7$(),t.Y8G("ngIf",s.validToken&&!s.showDownload),t.R7$(),t.Y8G("ngIf",s.showDownload),t.R7$(),t.Y8G("ngIf",!s.validToken&&!s.okMsg&&s.errorMsg))},dependencies:[_.bT,l.qT,l.me,l.BC,l.cb,l.j4,l.JD],styles:['@charset "UTF-8";.reset-wrapper[_ngcontent-%COMP%]{min-height:100vh;display:grid;place-items:center;background:#fff;padding:24px}.reset-card[_ngcontent-%COMP%]{width:100%;max-width:420px;background:#fff;border:1px solid #eef2f7;border-radius:16px;padding:28px 24px;box-shadow:0 10px 24px #1428500f}.logo[_ngcontent-%COMP%]{display:block;margin:0 auto 10px;height:48px;object-fit:contain}.title[_ngcontent-%COMP%]{text-align:center;margin:6px 0 4px;font-size:18px;color:#1f2937;font-weight:700}.subtitle[_ngcontent-%COMP%]{text-align:center;margin:0 0 16px;color:#6b7280;font-size:13px}.label[_ngcontent-%COMP%]{display:block;margin:12px 0 6px 2px;color:#334155;font-size:13px}.input[_ngcontent-%COMP%]{width:100%;padding:11px 44px 11px 12px;border:1px solid #d5dbe4;border-radius:10px;background:#fff;color:#111827;transition:box-shadow .15s ease,border-color .15s ease}.input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2b5df5;box-shadow:0 0 0 3px #2b5df51f}.hint[_ngcontent-%COMP%]{display:block;margin-top:6px;font-size:12px;color:#6b7280}.hint.error[_ngcontent-%COMP%]{color:#dc2626}.alert[_ngcontent-%COMP%]{border-radius:10px;padding:10px 12px;font-size:13px;margin-bottom:10px}.alert.warn[_ngcontent-%COMP%]{background:#fff7ed;color:#9a3412;border:1px solid #fdba74}.alert.ok[_ngcontent-%COMP%]{background:#ecfdf5;color:#065f46;border:1px solid #6ee7b7}.btn[_ngcontent-%COMP%]{width:100%;margin-top:18px;padding:12px 14px;border:0;border-radius:10px;background:#2b5df5;color:#fff;font-weight:600;cursor:pointer;transition:transform .05s ease,box-shadow .15s ease,background .15s}.btn[_ngcontent-%COMP%]:hover{background:#234fce;box-shadow:0 6px 18px #2b5df540}.btn[_ngcontent-%COMP%]:active{transform:translateY(1px)}.btn[_ngcontent-%COMP%]:disabled{opacity:.55;cursor:not-allowed;box-shadow:none}.footnote[_ngcontent-%COMP%]{margin:12px 0 0;text-align:center;color:#9aa3af;font-size:12px}.download-block[_ngcontent-%COMP%]{text-align:center;margin-top:8px}.download-title[_ngcontent-%COMP%]{margin:8px 0 4px;font-size:18px;font-weight:700;color:#1f2937}.download-subtitle[_ngcontent-%COMP%]{margin:0 0 14px;color:#475569;font-size:14px}.app-links[_ngcontent-%COMP%]{margin:14px 0 16px;display:flex;gap:12px;justify-content:center;align-items:center;flex-wrap:wrap}.app-links[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:48px;width:auto}.btn.secondary[_ngcontent-%COMP%]{background:#0f172a}.input-wrap[_ngcontent-%COMP%]{position:relative}.eye-btn[_ngcontent-%COMP%]{position:absolute;top:50%;right:8px;transform:translateY(-50%);width:32px;height:32px;border:none;background:transparent;cursor:pointer;display:grid;place-items:center;padding:0;outline:none}.eye-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;fill:#6b7280}.eye-btn[_ngcontent-%COMP%]:hover{opacity:1}.eye-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.eye-btn[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:#111827}.eye-btn[_ngcontent-%COMP%]:focus{outline:none}']}),r})();var D=i(3092);const Y=[{path:"",component:S}];let N=(()=>{var e;class r{}return(e=r).\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.$C({type:e}),e.\u0275inj=t.G2t({imports:[_.MD,l.X1,x.iI.forChild(Y),D.bv]}),r})()}}]);