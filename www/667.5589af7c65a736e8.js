"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[667],{667:($e,D,c)=>{c.r(D),c.d(D,{ReferenciasPageModule:()=>ye});var p=c(2881),d=c(9417),s=c(3092),I=c(9870),v=c(467),b=c(7550),C=c(2042),u=c(3662),E=c(1413),R=c(4843),j=c(152),M=c(3294),V=c(6977),y=c(7786),$=c(9172),T=c(5558),B=c(9437),G=c(7673),P=c(6354),_=function(o){return o[o.Creado=1]="Creado",o[o.Seguimiento=2]="Seguimiento",o[o.Cerrado=3]="Cerrado",o}(_||{});const X={Creado:"Creado",Seguimiento:"Seguimiento",Cerrado:"Cerrado"};function k(){return Object.keys(_).filter(o=>isNaN(Number(o))).map(o=>({nombre:X[o],valor:_[o]}))}var S=c(6231),e=c(1360);const w=["class","qr view"];function z(o,a){if(1&o&&e.nrm(0,"img",8),2&o){const n=e.XpG();e.Y8G("src",n.imagenBase64,e.B4B)}}let Y=(()=>{var o;class a{constructor(t){this.modalCtrl=t,this.imagenBase64=""}ngOnInit(){}close(){this.modalCtrl.dismiss()}}return(o=a).\u0275fac=function(t){return new(t||o)(e.rXU(s.W3))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-modal",8,"qr","view"]],inputs:{imagenBase64:"imagenBase64"},attrs:w,decls:10,vars:2,consts:[[1,"modalHeader"],["slot","end"],[3,"click"],["name","close"],[1,"ion-padding",3,"fullscreen"],[1,"modalform-title","ion-text-center"],[1,"upload-card"],[3,"src",4,"ngIf"],[3,"src"]],template:function(t,i){1&t&&(e.j41(0,"ion-header",0)(1,"ion-buttons",1)(2,"ion-button",2),e.bIt("click",function(){return i.close()}),e.nrm(3,"ion-icon",3),e.k0s()()(),e.j41(4,"ion-content",4)(5,"h2",5),e.EFF(6," QR"),e.k0s(),e.j41(7,"ion-item")(8,"ion-card",6),e.DNE(9,z,1,1,"img",7),e.k0s()()()),2&t&&(e.R7$(4),e.Y8G("fullscreen",!1),e.R7$(5),e.Y8G("ngIf",i.imagenBase64))},dependencies:[s.bv,s.Jm,s.QW,s.b_,s.W9,s.eU,s.iq,s.uz,d.X1,p.MD,p.bT],encapsulation:2}),a})();var U=c(980),A=c(5460),O=c(6152),h=c(7643),x=c(5312);let N=(()=>{var o;class a{constructor(t){this.http=t,this.apiUrl=x.c.apiUrl+"api/Referido"}getAllReferidosPaginated(t){let i=(new h.Nl).set("page",t.page.toString()).set("size",t.size.toString()).set("sortBy",t.sortBy).set("sortDir",t.sortDir).set("searchQuery",t.searchQuery||"").set("empresaID",t.empresaID.toString()).set("grupoID",t.grupoID.toString()).set("usuarioID",t.usuarioID.toString());return null!=t.statusEnum&&(i=i.set("estatus",t.statusEnum.toString())),this.http.get(`${this.apiUrl}/GetAllReferidosPaginated`,{params:i})}getReferidosByEmpresaPaginated(t){let i=(new h.Nl).set("empresaID",t.id.toString()).set("page",t.page.toString()).set("size",t.size.toString()).set("sortBy",t.sortBy).set("sortDir",t.sortDir).set("usuarioID",t.usuarioID.toString()).set("searchQuery",t.searchQuery||"");return null!=t.statusEnum&&(i=i.set("estatus",t.statusEnum.toString())),this.http.get(`${this.apiUrl}/GetReferidosByEmpresaPaginated`,{params:i})}getByID(t){let i=(new h.Nl).set("id",t);return this.http.get(`${this.apiUrl}/GetReferidoByID`,{params:i})}updateEstatus(t){return this.http.post(`${this.apiUrl}/UpdateStatus`,t)}getQR(t){let i=(new h.Nl).set("codigo",t);return this.http.get(`${this.apiUrl}/GetQR`,{params:i})}}return(o=a).\u0275fac=function(t){return new(t||o)(e.KVO(h.Qq))},o.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}),a})(),Q=(()=>{var o;class a{constructor(t){this.http=t,this.apiUrl=x.c.apiUrl+"api/SeguimientoReferido"}getSeguimientosReferido(t){let i=(new h.Nl).set("referidoID",t);return this.http.get(`${this.apiUrl}/GetSeguimientoReferido`,{params:i})}save(t){return this.http.post(`${this.apiUrl}/Save`,t)}}return(o=a).\u0275fac=function(t){return new(t||o)(e.KVO(h.Qq))},o.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}),a})();const W=["class","seguimiento referencia"],H=()=>({header:"Estatus de seguimiento"});function L(o,a){if(1&o&&(e.j41(0,"ion-select-option",16),e.EFF(1),e.k0s()),2&o){const n=a.$implicit,t=e.XpG();e.Y8G("value",n.valor)("disabled",n.valor===t.estatusReferenciaEnum.Creado),e.R7$(),e.SpI(" ",n.nombre," ")}}function J(o,a){1&o&&(e.j41(0,"ion-text",17),e.EFF(1," Campo requerido "),e.k0s())}function K(o,a){1&o&&(e.j41(0,"ion-text",17),e.EFF(1," Campo requerido "),e.k0s())}function Z(o,a){if(1&o){const n=e.RV6();e.j41(0,"ion-col",14)(1,"form",8),e.nrm(2,"ion-textarea",18),e.DNE(3,K,2,0,"ion-text",11),e.nrm(4,"br"),e.j41(5,"ion-button",12),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.enviarFormulario())}),e.EFF(6," Enviar seguimiento "),e.k0s()()()}if(2&o){let n,t;const i=e.XpG();e.R7$(),e.Y8G("formGroup",i.formulario),e.R7$(),e.AVh("invalid",(null==(n=i.getControl("comentario"))?null:n.invalid)&&(null==(n=i.getControl("comentario"))?null:n.touched)),e.R7$(),e.Y8G("ngIf",(null==(t=i.getControl("comentario"))?null:t.invalid)&&(null==(t=i.getControl("comentario"))?null:t.touched)),e.R7$(2),e.Y8G("disabled",i.formEnviado)}}function q(o,a){if(1&o&&(e.j41(0,"ion-card",19)(1,"ion-card-header")(2,"ion-card-subtitle"),e.EFF(3),e.k0s()(),e.j41(4,"ion-card-content")(5,"p"),e.EFF(6),e.k0s()()()),2&o){const n=a.$implicit,t=e.XpG();e.R7$(3),e.JRh(t.formatFecha(n.fechaSeguimiento)),e.R7$(3),e.JRh(n.comentario)}}let ee=(()=>{var o;class a{constructor(t,i,r,l,f,m){this.fb=t,this.modalCtrl=i,this.toastController=r,this.loadingCtrl=l,this.referidoService=f,this.seguimientoReferidoService=m,this.formEnviado=!1,this.numSeguimientos=0,this.seguimientos=[],this.estatus=[],this.estatusReferenciaEnum=_,this.id=void 0,this.formulario=this.fb.group({comentario:["",[d.k0.required,(0,A.a)()]]}),this.formStatus=this.fb.group({status:["",d.k0.required]})}ngOnInit(){var t=this;return(0,v.A)(function*(){t.estatus=k();const i=yield t.loadingCtrl.create({message:"Cargando datos..."});yield i.present();try{const r=yield(0,R._)(t.referidoService.getByID(t.id));t.referido=r.data,t.formStatus.patchValue({status:t.referido.estatusReferenciaEnum}),t.getSeguimientos()}catch(r){console.error("Error al cargar datos",r)}finally{i.dismiss()}})()}getSeguimientos(){this.seguimientoReferidoService.getSeguimientosReferido(this.id).subscribe({next:t=>{this.seguimientos=t.data,this.numSeguimientos=this.seguimientos.length}})}enviarFormularioStatus(){if(!this.formEnviado){if(this.formEnviado=!0,this.formStatus.invalid)return this.formStatus.markAllAsTouched(),void(this.formEnviado=!1);var t={id:this.id,estatusReferenciaEnum:this.formStatus.controls.status.value};this.referidoService.updateEstatus(t).pipe((0,U.j)(()=>{this.formEnviado=!1})).subscribe({next:i=>{i&&(this.toastController.create({message:"Estatus actualizado.",duration:3e3,color:"success",position:"top"}).then(r=>r.present()),this.getSeguimientos(),this.referido.estatusReferenciaEnum=t.estatusReferenciaEnum)}})}}enviarFormulario(){if(!this.formEnviado){if(this.formEnviado=!0,this.formulario.invalid)return this.formulario.markAllAsTouched(),void(this.formEnviado=!1);var t={comentario:(0,O.H)(this.formulario.controls.comentario.value),referidoID:this.id};this.seguimientoReferidoService.save(t).pipe((0,U.j)(()=>{this.formEnviado=!1})).subscribe({next:i=>{i&&(this.toastController.create({message:"seguimiento guardado.",duration:3e3,color:"success",position:"top"}).then(r=>r.present()),this.getSeguimientos(),this.formulario.reset())}})}}getControl(t){return this.formulario.get(t)}close(){this.modalCtrl.dismiss()}formatFecha(t){const i=new Date(t),r=i.getDate().toString().padStart(2,"0");let l=i.toLocaleString("es-MX",{month:"long"});return l=l.charAt(0).toUpperCase()+l.slice(1),`${r}-${l}-${i.getFullYear()}`}}return(o=a).\u0275fac=function(t){return new(t||o)(e.rXU(d.ok),e.rXU(s.W3),e.rXU(s.K_),e.rXU(s.Xi),e.rXU(N),e.rXU(Q))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-modal",8,"seguimiento","referencia"]],inputs:{id:"id"},attrs:W,decls:53,vars:17,consts:[[1,"modalHeader"],["slot","end"],[3,"click"],["name","close"],[1,"ion-padding",3,"fullscreen"],[1,"modalform-title","ion-text-center"],["size","12"],["color","primary"],[3,"formGroup"],["okText","Ok","cancelText","Cancelar","label-placement","floating","label","Estatus seguimiento","formControlName","status",1,"inputForm",3,"ionBlur","interfaceOptions"],[3,"value","disabled",4,"ngFor","ngForOf"],["color","danger",4,"ngIf"],[3,"click","disabled"],["size","12","size-md","12",4,"ngIf"],["size","12","size-md","12"],["color","light",4,"ngFor","ngForOf"],[3,"value","disabled"],["color","danger"],["formControlName","comentario","label-placement","floating","label","Seguimiento","autoGrow","true","rows","4","maxlength","500","placeholder","Escribe tu seguimiento",1,"inputForm"],["color","light"]],template:function(t,i){if(1&t&&(e.j41(0,"ion-header",0)(1,"ion-buttons",1)(2,"ion-button",2),e.bIt("click",function(){return i.close()}),e.nrm(3,"ion-icon",3),e.k0s()()(),e.j41(4,"ion-content",4)(5,"h2",5),e.EFF(6,"Seguimiento de referido"),e.k0s(),e.j41(7,"ion-grid")(8,"ion-row")(9,"ion-col",6)(10,"ion-text",7)(11,"h2"),e.EFF(12,"Referido"),e.k0s()(),e.j41(13,"b"),e.EFF(14,"Nombre:"),e.k0s(),e.EFF(15),e.nrm(16,"br"),e.j41(17,"b"),e.EFF(18,"Email"),e.k0s(),e.EFF(19),e.nrm(20,"br"),e.j41(21,"b"),e.EFF(22,"Celular:"),e.k0s(),e.EFF(23),e.nrm(24,"br"),e.j41(25,"b"),e.EFF(26,"Producto:"),e.k0s(),e.EFF(27),e.nrm(28,"br")(29,"br"),e.j41(30,"h3"),e.EFF(31,"Embajador que realizo la referencia: "),e.k0s(),e.EFF(32),e.k0s()(),e.j41(33,"ion-row")(34,"ion-col",6)(35,"ion-text",7)(36,"h2"),e.EFF(37,"Estatus"),e.k0s()(),e.j41(38,"form",8)(39,"ion-select",9),e.bIt("ionBlur",function(){let l;return null==(l=i.getControl("status"))?null:l.markAsTouched()}),e.DNE(40,L,2,3,"ion-select-option",10),e.k0s(),e.DNE(41,J,2,0,"ion-text",11),e.nrm(42,"br"),e.j41(43,"ion-button",12),e.bIt("click",function(){return i.enviarFormularioStatus()}),e.EFF(44," Actualizar estatus "),e.k0s()()()(),e.j41(45,"ion-row")(46,"ion-col",6)(47,"ion-text",7)(48,"h2"),e.EFF(49),e.k0s()()(),e.DNE(50,Z,7,5,"ion-col",13),e.j41(51,"ion-col",14),e.DNE(52,q,7,2,"ion-card",15),e.k0s()()()()),2&t){let r,l;e.R7$(4),e.Y8G("fullscreen",!1),e.R7$(11),e.SpI(" ",null==i.referido?null:i.referido.nombreCompleto,""),e.R7$(4),e.SpI(" ",null==i.referido?null:i.referido.email,""),e.R7$(4),e.SpI(" ",null==i.referido?null:i.referido.celular,""),e.R7$(4),e.SpI(" ",null==i.referido?null:i.referido.productoNombre,""),e.R7$(5),e.SpI(" ",null==i.referido?null:i.referido.usuarioNombreCompleto," "),e.R7$(6),e.Y8G("formGroup",i.formStatus),e.R7$(),e.AVh("invalid",(null==(r=i.getControl("status"))?null:r.invalid)&&(null==(r=i.getControl("status"))?null:r.touched)),e.Y8G("interfaceOptions",e.lJ4(16,H)),e.R7$(),e.Y8G("ngForOf",i.estatus),e.R7$(),e.Y8G("ngIf",(null==(l=i.getControl("status"))?null:l.invalid)&&(null==(l=i.getControl("status"))?null:l.touched)),e.R7$(2),e.Y8G("disabled",i.formEnviado),e.R7$(6),e.SpI("Seguimientos (",i.numSeguimientos,")"),e.R7$(),e.Y8G("ngIf",(null==i.referido?null:i.referido.estatusReferenciaEnum)==i.estatusReferenciaEnum.Seguimiento),e.R7$(2),e.Y8G("ngForOf",i.seguimientos)}},dependencies:[s.bv,s.Jm,s.QW,s.b_,s.I9,s.ME,s.HW,s.hU,s.W9,s.lO,s.eU,s.iq,s.ln,s.Nm,s.Ip,s.IO,s.nc,s.Je,s.Gw,d.X1,d.qT,d.BC,d.cb,d.tU,d.j4,d.JD,p.MD,p.Sq,p.bT],encapsulation:2}),a})();var te=c(8311),ie=c(6897),oe=c(2101),ne=c(7248),F=c(2490);const re=["selectableComponent"],ae=()=>[20,50,100];function se(o,a){if(1&o){const n=e.RV6();e.j41(0,"ion-col",10)(1,"ion-item",11)(2,"ion-label",12),e.EFF(3,"Filtro por empresa"),e.k0s(),e.j41(4,"ionic-selectable",30),e.bIt("onChange",function(i){e.eBV(n);const r=e.XpG();return e.Njj(r.onEmpresaSelect(i))})("onClear",function(i){e.eBV(n);const r=e.XpG();return e.Njj(r.onEmpresaClear(i))}),e.k0s()()()}if(2&o){const n=e.XpG();e.R7$(4),e.Y8G("items",n.empresas)("canSearch",!0)("canClear",!0)}}function le(o,a){1&o&&(e.j41(0,"ion-item",33)(1,"p",34),e.EFF(2," Solo se muestran los primeros 30 usuarios encontrados. Si no encuentra el deseado, utilice el buscador para obtener un resultado m\xe1s preciso. "),e.k0s()())}function ce(o,a){if(1&o){const n=e.RV6();e.j41(0,"ion-col",10)(1,"ion-item",11)(2,"ion-label",12),e.EFF(3,"Filtro por embajador"),e.k0s(),e.j41(4,"ionic-selectable",31,0),e.bIt("onSearch",function(i){e.eBV(n);const r=e.XpG();return e.Njj(r.onSearchChange(i))})("onOpen",function(i){e.eBV(n);const r=e.XpG();return e.Njj(r.onOpen(i))})("onChange",function(i){e.eBV(n);const r=e.XpG();return e.Njj(r.onUsuarioSelect(i))})("onClear",function(i){e.eBV(n);const r=e.XpG();return e.Njj(r.onUsuarioClear(i))}),e.DNE(6,le,3,0,"ng-template",32),e.k0s()()()}if(2&o){const n=e.XpG();e.R7$(4),e.Y8G("items",n.usuarios)("searchFailText","No se encontraron usuarios.")("canSearch",!0)("canClear",!0)}}function ue(o,a){1&o&&(e.j41(0,"th",35),e.EFF(1," Nombre "),e.k0s())}function me(o,a){if(1&o&&(e.j41(0,"td",36),e.EFF(1),e.k0s()),2&o){const n=a.$implicit;e.R7$(),e.SpI(" ",n.nombre," ")}}function de(o,a){1&o&&(e.j41(0,"th",35),e.EFF(1," Contacto "),e.k0s())}function fe(o,a){if(1&o&&(e.j41(0,"td",36),e.EFF(1),e.k0s()),2&o){const n=a.$implicit;e.R7$(),e.Lme(" ",n.email," ",n.celular," ")}}function pe(o,a){1&o&&(e.j41(0,"th",35),e.EFF(1," Producto "),e.k0s())}function ge(o,a){if(1&o&&(e.j41(0,"div")(1,"small",38),e.EFF(2),e.k0s()()),2&o){const n=e.XpG().$implicit;e.R7$(),e.Y8G("ngClass",n.productoVigente?"text-success":"text-danger"),e.R7$(),e.SpI(" ",n.productoVigente?"Vigente":"No vigente"," ")}}function he(o,a){if(1&o&&(e.j41(0,"td",36),e.EFF(1),e.DNE(2,ge,3,2,"div",37),e.k0s()),2&o){const n=a.$implicit;e.R7$(),e.SpI(" ",n.producto," "),e.R7$(),e.Y8G("ngIf",null!==n.vigente)}}function Re(o,a){1&o&&(e.j41(0,"th",35),e.EFF(1," Embajador "),e.k0s())}function Se(o,a){if(1&o&&(e.j41(0,"td",36),e.EFF(1),e.k0s()),2&o){const n=a.$implicit;e.R7$(),e.SpI(" ",n.embajador," ")}}function ve(o,a){1&o&&(e.j41(0,"th",35),e.EFF(1," Empresa "),e.k0s())}function Ce(o,a){if(1&o&&(e.j41(0,"td",36),e.EFF(1),e.k0s()),2&o){const n=a.$implicit;e.R7$(),e.SpI(" ",n.empresa," ")}}function _e(o,a){1&o&&(e.j41(0,"th",35),e.EFF(1," Estatus Referencia "),e.k0s())}function be(o,a){if(1&o&&(e.j41(0,"td",36),e.EFF(1),e.k0s()),2&o){const n=a.$implicit;e.R7$(),e.SpI(" ",n.estatusRerefencia," ")}}function Ee(o,a){1&o&&e.nrm(0,"tr",39)}function Fe(o,a){if(1&o){const n=e.RV6();e.j41(0,"tr",40),e.bIt("click",function(){const i=e.eBV(n).$implicit,r=e.XpG();return e.Njj(r.seguimientoModal(i.id))}),e.k0s()}}function De(o,a){if(1&o&&(e.j41(0,"tr",41)(1,"td",42),e.EFF(2," No se encontraron registros disponibles. "),e.k0s()()),2&o){const n=e.XpG();e.R7$(),e.BMQ("colspan",n.displayedColumns.length)}}const Ie=[{path:"",component:(()=>{var o;class a{constructor(t,i,r,l,f,m,g){this.loadingCtrl=t,this.empresasService=i,this.grupoService=r,this.modalCtrl=l,this.route=f,this.usuarioService=m,this.referidoService=g,this.dataSourceTable=new u.I6,this.displayedColumns=[],this.allColumns=["Nombre","Email","Producto","Embajador","EstatusReferencia"],this.inputBuscar=new E.B,this.query="",this.empresaID=0,this.userid=0,this.inputBusquedaText="Buscar por nombre, email, celular o producto",this.RolesEnum=S.$u,this.grupos=[],this.empresas=[],this.estatus=[],this.filterEmpresID=0,this.filterGrupoID=0,this.filterEstatusEnum=void 0,this.filterUsuario=0,this.usuarios=[],this.searchSubject=new E.B,this.destroy$=new E.B,this.setupSearch()}ngAfterViewInit(){}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngOnInit(){var t=this;return(0,v.A)(function*(){var i;let l=t.route.snapshot.data.resolverData.usuario;if(t.rolUsuario=null===(i=l.roles)||void 0===i?void 0:i.enumValue,t.estatus=k(),t.userid=l.id,t.displayedColumns=[...t.allColumns],t.rolUsuario===S.$u.Admin){const g=t.displayedColumns.indexOf("Producto");-1!==g&&t.displayedColumns.splice(g+1,0,"Empresa"),t.inputBusquedaText="Buscar por nombre, email, celular, producto, empresa o grupo"}const f=yield t.loadingCtrl.create({message:"Cargando datos..."});yield f.present();try{if(t.rolUsuario==S.$u.Socio){const m=yield(0,R._)(t.usuarioService.getEmpresaByUsuario(t.userid));t.empresaID=m.data.id}else{const m=yield(0,R._)(t.empresasService.getAllEmpresas());t.empresas=(null==m?void 0:m.data)||[];const g=yield(0,R._)(t.grupoService.getAllGrupos());t.grupos=(null==g?void 0:g.data)||[]}t.dataSourceTable.paginator=t.paginator,t.loadtable()}catch(m){console.error("Error al cargar datos",m)}finally{f.dismiss()}t.inputBuscar.pipe((0,j.B)(1e3),(0,M.F)(),(0,V.Q)(t.destroy$)).subscribe(m=>{t.query=m.toString(),t.loadtable()})})()}loadtable(){switch(this.rolUsuario){case S.$u.Admin:this.loadtableAll();break;case S.$u.Socio:this.loadtableByEmpresa()}}loadtableAll(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),(0,y.h)(this.sort.sortChange,this.paginator.page).pipe((0,$.Z)({}),(0,T.n)(()=>this.referidoService.getAllReferidosPaginated({page:this.paginator.pageIndex,size:this.paginator.pageSize,sortBy:this.sort.active,sortDir:this.sort.direction,searchQuery:this.query,grupoID:this.filterGrupoID,empresaID:this.filterEmpresID,statusEnum:this.filterEstatusEnum,usuarioID:this.filterUsuario}).pipe((0,B.W)(()=>(0,G.of)(null)))),(0,P.T)(t=>null===t?[]:(this.total=t.data.total,t.data.items))).subscribe(t=>{this.dataSourceTable=new u.I6(t)})}loadtableByEmpresa(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),(0,y.h)(this.sort.sortChange,this.paginator.page).pipe((0,$.Z)({}),(0,T.n)(()=>this.referidoService.getReferidosByEmpresaPaginated({id:this.empresaID,page:this.paginator.pageIndex,size:this.paginator.pageSize,sortBy:this.sort.active,sortDir:this.sort.direction,searchQuery:this.query,statusEnum:this.filterEstatusEnum,usuarioID:this.filterUsuario}).pipe((0,B.W)(()=>(0,G.of)(null)))),(0,P.T)(t=>null===t?[]:(this.total=t.data.total,t.data.items))).subscribe(t=>{this.dataSourceTable=new u.I6(t)})}seguimientoModal(t){var i=this;return(0,v.A)(function*(){const r=yield i.modalCtrl.create({component:ee,cssClass:"modal-empresa",componentProps:{id:t}});yield r.present(),yield r.onDidDismiss(),i.loadtable()})()}formatFecha(t){if(null==t)return"No aplica";const i=new Date(t),r=i.getDate().toString().padStart(2,"0");let l=i.toLocaleString("es-MX",{month:"long"});return l=l.charAt(0).toUpperCase()+l.slice(1),`${r} ${l} ${i.getFullYear()}`}onGrupoSelect(t){null!=t.value&&null!=t.value&&(this.filterGrupoID=t.value.id,this.loadtable())}onGrupoClear(t){this.filterGrupoID=0,this.loadtable()}onEmpresaSelect(t){null!=t.value&&null!=t.value&&(this.filterEmpresID=t.value.id,this.loadtable())}onEmpresaClear(t){this.filterEmpresID=0,this.loadtable()}onEstatusSelect(t){null!=t.value&&null!=t.value&&(this.filterEstatusEnum=t.value.valor,this.loadtable())}onEstatusClear(t){this.filterEstatusEnum=void 0,this.loadtable()}onSearchChange(t){t.component.startSearch(),this.searchSubject.next(t)}setupSearch(){this.searchSubject.pipe((0,j.B)(300)).subscribe(t=>{const i=t.text.trim();if(i.length<2&&""!=i)return t.component.items=this.usuarios,void t.component.endSearch();this.usuarioService.busquedaUsuario(i.toLowerCase()).subscribe(r=>{this.usuarios=r.data,t.component.items=this.usuarios,t.component.endSearch()},r=>{t.component.items=[],t.component.endSearch()})})}onOpen(t){this.selectableComponent&&(this.selectableComponent._onSearchbarClear=function(){this._searchText="",this._filterItems()})}onUsuarioSelect(t){null!=t.value&&null!=t.value&&(this.filterUsuario=t.value.id,this.loadtable())}onUsuarioClear(t){this.filterUsuario=0,this.loadtable()}viewQR(t){var i=this;return(0,v.A)(function*(){var r=yield(0,R._)(i.referidoService.getQR(t));const l=yield i.modalCtrl.create({component:Y,cssClass:"modal-empresa",componentProps:{imagenBase64:r.data}});yield l.present(),yield l.onDidDismiss()})()}}return(o=a).\u0275fac=function(t){return new(t||o)(e.rXU(s.Xi),e.rXU(te.z),e.rXU(ie.b),e.rXU(s.W3),e.rXU(oe.nX),e.rXU(ne.o),e.rXU(N))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-referencias"]],viewQuery:function(t,i){if(1&t&&(e.GBs(b.iy,5),e.GBs(C.B4,5),e.GBs(re,5)),2&t){let r;e.mGM(r=e.lsd())&&(i.paginator=r.first),e.mGM(r=e.lsd())&&(i.sort=r.first),e.mGM(r=e.lsd())&&(i.selectableComponent=r.first)}},standalone:!1,decls:52,vars:14,consts:[["selectableComponent",""],[1,"pagesHeader"],["slot","start"],["name","star","color","white"],[1,"pagesContent"],[1,"ion-align-items-center"],["size","12","size-md","9",1,"ion-text-center"],["autocomplete","off",1,"inputBusqueda",3,"ionInput","placeholder"],["slot","end","name","search","aria-hidden","true"],["size","12","size-md","3","class","ion-text-center",4,"ngIf"],["size","12","size-md","3",1,"ion-text-center"],[1,"inputBusqueda"],["position","floating"],["item-content","","itemValueField","valor","closeButtonSlot","end","itemTextField","nombre","closeButtonText","Cancelar","clearButtonText","Limpiar",3,"onChange","onClear","items","canSearch","canClear"],[1,"referidosHeader"],[1,"title"],[2,"overflow-x","auto"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","Nombre"],["mat-header-cell","","style","padding-left: 1rem;","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","style","padding-left: 1rem;",4,"matCellDef"],["matColumnDef","Email"],["matColumnDef","Producto"],["matColumnDef","Embajador"],["matColumnDef","Empresa"],["matColumnDef","EstatusReferencia"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","mydivoutermulti elemento-renglon row_clickable",3,"click",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"length","pageSizeOptions","pageSize"],["item-content","","itemValueField","id","closeButtonSlot","end","itemTextField","razonSocial","closeButtonText","Cancelar","clearButtonText","Limpiar",3,"onChange","onClear","items","canSearch","canClear"],["item-content","","itemValueField","id","closeButtonSlot","end","itemTextField","nombreCompleto","closeButtonText","Cancelar","searchPlaceholder","Buscar usuario...","clearButtonText","Limpiar",3,"onSearch","onOpen","onChange","onClear","items","searchFailText","canSearch","canClear"],["ionicSelectableMessageTemplate",""],["text-wrap",""],[2,"color","grey","font-size","small"],["mat-header-cell","","mat-sort-header","",2,"padding-left","1rem"],["mat-cell","",2,"padding-left","1rem"],[4,"ngIf"],[3,"ngClass"],["mat-header-row",""],["mat-row","",1,"mydivoutermulti","elemento-renglon","row_clickable",3,"click"],[1,"mat-row"],[2,"text-align","center","padding","1rem"]],template:function(t,i){1&t&&(e.j41(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-buttons",2),e.nrm(3,"ion-menu-button"),e.k0s(),e.j41(4,"ion-title")(5,"h1"),e.nrm(6,"ion-icon",3),e.EFF(7," Referencia"),e.k0s()()()(),e.j41(8,"ion-content",4)(9,"div")(10,"ion-grid")(11,"ion-row",5)(12,"ion-col",6)(13,"ion-input",7),e.bIt("ionInput",function(l){return i.inputBuscar.next(l.detail.value||"")}),e.nrm(14,"ion-icon",8),e.k0s()()(),e.j41(15,"ion-row",5),e.DNE(16,se,5,3,"ion-col",9)(17,ce,7,4,"ion-col",9),e.j41(18,"ion-col",10)(19,"ion-item",11)(20,"ion-label",12),e.EFF(21,"Filtro por estatus"),e.k0s(),e.j41(22,"ionic-selectable",13),e.bIt("onChange",function(l){return i.onEstatusSelect(l)})("onClear",function(l){return i.onEstatusClear(l)}),e.k0s()()()()()(),e.j41(23,"ion-card")(24,"ion-card-header",14)(25,"ion-card-title",15),e.EFF(26,"Referencias"),e.k0s()(),e.j41(27,"ion-card-content")(28,"div",16)(29,"table",17),e.qex(30,18),e.DNE(31,ue,2,0,"th",19)(32,me,2,1,"td",20),e.bVm(),e.qex(33,21),e.DNE(34,de,2,0,"th",19)(35,fe,2,2,"td",20),e.bVm(),e.qex(36,22),e.DNE(37,pe,2,0,"th",19)(38,he,3,2,"td",20),e.bVm(),e.qex(39,23),e.DNE(40,Re,2,0,"th",19)(41,Se,2,1,"td",20),e.bVm(),e.qex(42,24),e.DNE(43,ve,2,0,"th",19)(44,Ce,2,1,"td",20),e.bVm(),e.qex(45,25),e.DNE(46,_e,2,0,"th",19)(47,be,2,1,"td",20),e.bVm(),e.DNE(48,Ee,1,0,"tr",26)(49,Fe,1,0,"tr",27)(50,De,3,1,"tr",28),e.k0s()(),e.nrm(51,"mat-paginator",29),e.k0s()()()),2&t&&(e.R7$(13),e.Y8G("placeholder",i.inputBusquedaText),e.R7$(3),e.Y8G("ngIf",i.rolUsuario===i.RolesEnum.Admin),e.R7$(),e.Y8G("ngIf",i.rolUsuario===i.RolesEnum.Admin),e.R7$(5),e.Y8G("items",i.estatus)("canSearch",!0)("canClear",!0),e.R7$(7),e.Y8G("dataSource",i.dataSourceTable),e.R7$(19),e.Y8G("matHeaderRowDef",i.displayedColumns)("matHeaderRowDefSticky",!0),e.R7$(),e.Y8G("matRowDefColumns",i.displayedColumns),e.R7$(2),e.Y8G("length",i.total)("pageSizeOptions",e.lJ4(13,ae))("pageSize",50))},dependencies:[p.YU,p.bT,s.QW,s.b_,s.I9,s.ME,s.tN,s.hU,s.W9,s.lO,s.eU,s.iq,s.$w,s.uz,s.he,s.MC,s.ln,s.BC,s.ai,s.Gw,u.Zl,u.tL,u.ji,u.cC,u.YV,u.iL,u.KS,u.$R,u.YZ,u.NB,u.ky,b.iy,C.B4,C.aE,F.ec,F.pF],styles:[".text-success[_ngcontent-%COMP%]{color:green}.text-danger[_ngcontent-%COMP%]{color:red}"]}),a})()}];let je=(()=>{var o;class a{}return(o=a).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[I.iI.forChild(Ie),I.iI]}),a})(),ye=(()=>{var o;class a{}return(o=a).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[p.MD,d.YN,s.bv,je,u.tP,b.Ou,C.NQ,F.ec]}),a})()}}]);