"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[514],{514:(Z,O,f)=>{f.r(O),f.d(O,{EmbajadoresDiagramaModule:()=>U});var y=f(2881),m=f(3092),w=f(9870),t=f(1360),I=f(7248);const F=["svgRef"];function B(e,r){if(1&e){const o=t.RV6();t.qSk(),t.j41(0,"g",22),t.bIt("click",function(){t.eBV(o);const n=t.XpG();return t.Njj(n.goHome())}),t.nrm(1,"rect",23),t.j41(2,"text",24),t.EFF(3,"\u{1f3e0}"),t.k0s()()}if(2&e){const o=t.XpG();t.R7$(),t.BMQ("x",((null==o.rootNode?null:o.rootNode.x)||0)-80)("y",null==o.rootNode?null:o.rootNode.y),t.R7$(),t.BMQ("x",((null==o.rootNode?null:o.rootNode.x)||0)-65)("y",((null==o.rootNode?null:o.rootNode.y)||0)+21)}}function G(e,r){if(1&e){const o=t.RV6();t.qSk(),t.j41(0,"g",22),t.bIt("click",function(){t.eBV(o);const n=t.XpG();return t.Njj(n.goUp())}),t.nrm(1,"rect",23),t.j41(2,"text",24),t.EFF(3,"\u2b06\ufe0f"),t.k0s()()}if(2&e){const o=t.XpG();t.R7$(),t.BMQ("x",((null==o.rootNode?null:o.rootNode.x)||0)-40)("y",null==o.rootNode?null:o.rootNode.y),t.R7$(),t.BMQ("x",((null==o.rootNode?null:o.rootNode.x)||0)-25)("y",((null==o.rootNode?null:o.rootNode.y)||0)+21)}}function X(e,r){if(1&e&&(t.qSk(),t.nrm(0,"path",25)),2&e){const o=t.XpG();t.BMQ("d",o.busVerticalPath)}}function Y(e,r){if(1&e&&(t.qSk(),t.nrm(0,"path",25)),2&e){const o=t.XpG();t.BMQ("d",o.busHorizontalPath)}}function T(e,r){if(1&e&&(t.qSk(),t.nrm(0,"path",25)),2&e){const o=t.XpG().$implicit;t.BMQ("d",o.rutaDesdeBus)}}function Q(e,r){if(1&e&&(t.qSk(),t.qex(0),t.DNE(1,T,1,1,"path",17),t.bVm()),2&e){const o=r.$implicit;t.R7$(),t.Y8G("ngIf",o.rutaDesdeBus)}}function H(e,r){if(1&e&&(t.qSk(),t.nrm(0,"path",25)),2&e){const o=t.XpG().$implicit;t.BMQ("d",o.rutaDesdePadre)}}function W(e,r){if(1&e&&(t.qSk(),t.qex(0),t.DNE(1,H,1,1,"path",17),t.bVm()),2&e){const o=r.$implicit;t.R7$(),t.Y8G("ngIf",o.rutaDesdePadre)}}function S(e,r){if(1&e&&(t.qSk(),t.j41(0,"g",26),t.nrm(1,"rect",27),t.j41(2,"text",28),t.EFF(3),t.k0s(),t.j41(4,"text",29),t.EFF(5),t.k0s()()),2&e){const o=t.XpG();t.R7$(),t.BMQ("x",o.rootNode.x)("y",o.rootNode.y)("width",o.rootNode.w)("height",o.rootNode.h),t.R7$(),t.BMQ("x",o.rootNode.x+16)("y",o.rootNode.y+25),t.R7$(),t.JRh(o.rootNode.nombre),t.R7$(),t.BMQ("x",o.rootNode.x+16)("y",o.rootNode.y+42),t.R7$(),t.JRh(o.rootNode.contacto)}}function V(e,r){if(1&e){const o=t.RV6();t.qSk(),t.j41(0,"g",22),t.bIt("click",function(){const n=t.eBV(o).$implicit,c=t.XpG();return t.Njj(c.onN2Click(n))}),t.nrm(1,"rect",30),t.j41(2,"text",31),t.EFF(3),t.k0s(),t.j41(4,"text",29),t.EFF(5),t.k0s()()}if(2&e){const o=r.$implicit;t.R7$(),t.BMQ("x",o.x)("y",o.y)("width",o.w)("height",o.h),t.R7$(),t.BMQ("x",o.x+16)("y",o.y+24),t.R7$(),t.JRh(o.nombre),t.R7$(),t.BMQ("x",o.x+16)("y",o.y+40),t.R7$(),t.JRh(o.contacto)}}function q(e,r){if(1&e&&(t.qSk(),t.j41(0,"g",26),t.nrm(1,"rect",32),t.j41(2,"text",31),t.EFF(3),t.k0s(),t.j41(4,"text",29),t.EFF(5),t.k0s()()),2&e){const o=r.$implicit;t.R7$(),t.BMQ("x",o.x)("y",o.y)("width",o.w)("height",o.h),t.R7$(),t.BMQ("x",o.x+16)("y",o.y+24),t.R7$(),t.JRh(o.nombre),t.R7$(),t.BMQ("x",o.x+16)("y",o.y+40),t.R7$(),t.JRh(o.contacto)}}class P{constructor(){this.x=0,this.y=0,this.w=180,this.h=60,this.usuarioId=0,this.parentId=0,this.nombre="",this.contacto="",this.role="n3"}}const L=[{path:"",component:(()=>{var e;class r{getCssVar(i){return getComputedStyle(document.documentElement).getPropertyValue(i).trim()}constructor(i){this.usuarioService=i,this.scale=1,this.panX=0,this.panY=0,this.transform="translate(0,0) scale(1)",this.isPanning=!1,this.startX=0,this.startY=0,this.miniWidth=1200,this.miniHeight=500,this.n2Nodes=[],this.n3Nodes=[],this.busVerticalPath="",this.busHorizontalPath="",this.topMargin=90,this.gapRootN2=90,this.gapN2N3=90,this.colGapX=340,this.busOffset=45,this.ctx=null,this.onMouseDown=n=>{this.isPanning=!0,this.startX=n.clientX,this.startY=n.clientY},this.onMouseMove=n=>{this.isPanning&&(this.panX+=n.clientX-this.startX,this.panY+=n.clientY-this.startY,this.startX=n.clientX,this.startY=n.clientY,this.updateTransform())},this.onMouseUp=()=>{this.isPanning=!1},this.onWheel=n=>{n.preventDefault(),this.scale*=1+.1*(n.deltaY<0?1:-1),this.updateTransform()}}ngOnInit(){const i=document.createElement("canvas");this.ctx=i.getContext("2d"),this.load(0);const n=this.svgRef.nativeElement;n.addEventListener("mousedown",this.onMouseDown),n.addEventListener("mousemove",this.onMouseMove),n.addEventListener("mouseup",this.onMouseUp),n.addEventListener("mouseleave",this.onMouseUp),n.addEventListener("wheel",this.onWheel,{passive:!1})}updateTransform(){this.transform=`translate(${this.panX}, ${this.panY}) scale(${this.scale})`}nameOf(i){return i?i.nombre?String(i.nombre):[i.nombres,i.apellidos].filter(Boolean).join(" ").trim():""}contactOf(i){var n,c,a;return i&&null!==(n=null!==(c=null!==(a=i.contacto)&&void 0!==a?a:i.email)&&void 0!==c?c:i.celular)&&void 0!==n?n:""}idOf(i){var n,c;return null!==(n=null!==(c=null==i?void 0:i.usuarioId)&&void 0!==c?c:null==i?void 0:i.id)&&void 0!==n?n:0}measureW(i,n,c=14){if(!this.ctx)return 180;this.ctx.font="18px sans-serif";const _=this.ctx.measureText(i||"").width;this.ctx.font="12px sans-serif";const v=this.ctx.measureText(n||"").width;return Math.max(220,Math.ceil(Math.max(_,v)+c+14))}load(i){var n;this.n2Nodes=[],this.n3Nodes=[],this.busVerticalPath="",this.busHorizontalPath="",this.panX=0,this.panY=0,this.scale=1,this.updateTransform();const c=(null===(n=this.svgRef)||void 0===n||null===(n=n.nativeElement)||void 0===n||null===(n=n.parentElement)||void 0===n?void 0:n.clientWidth)||1200;this.miniWidth=c,this.usuarioService.getArbolEmbajadores(i).subscribe({next:a=>{var _,v,j,E,R,k;const d=new P;d.role="root",d.nombre=this.nameOf(null==a?void 0:a.nivel1),d.contacto=this.contactOf(null==a?void 0:a.nivel1),d.usuarioId=this.idOf(null==a?void 0:a.nivel1),d.parentId=null!==(_=null==a||null===(v=a.nivel1)||void 0===v?void 0:v.parentId)&&void 0!==_?_:0,d.w=this.measureW(d.nombre,d.contacto),d.h=60,d.x=Math.round(this.miniWidth/2-d.w/2),d.y=this.topMargin,this.rootNode=d;const D=(null==a?void 0:a.nivel2)||[],J=d.y+this.gapRootN2,b=[],$=Math.round(d.x+d.w/2),p=Math.round(d.y+this.gapRootN2/2);if(D.length>0){const N=this.miniWidth/2-(D.length-1)*this.colGapX/2;if(D.forEach((u,M)=>{var h;const s=new P;s.role="n2",s.usuarioId=this.idOf(u),s.parentId=null!==(h=null==u?void 0:u.parentId)&&void 0!==h?h:0,s.nombre=this.nameOf(u),s.contacto=this.contactOf(u),s.w=this.measureW(s.nombre,s.contacto),s.h=60,s.x=Math.round(N+M*this.colGapX-s.w/2),s.y=J;const l=Math.round(s.x+s.w/2);s.rutaDesdeBus=`M ${l} ${p} L ${l} ${s.y}`,b.push(l),this.n2Nodes.push(s)}),this.busVerticalPath=`M ${$} ${d.y+d.h} L ${$} ${p}`,1===b.length){const u=b[0],M=Math.min($,u),h=Math.max($,u);this.busHorizontalPath=`M ${M} ${p} L ${h} ${p}`}else this.busHorizontalPath=`M ${Math.min(...b)} ${p} L ${Math.max(...b)} ${p}`}const A=(null==a?void 0:a.nivel3)||[];this.n2Nodes.forEach(g=>{const N=A.filter(h=>{var s;return(null!==(s=null==h?void 0:h.parentId)&&void 0!==s?s:0)===g.usuarioId});if(!N.length)return;const u=Math.round(g.x+g.w/2),M=g.y+g.h+(this.gapN2N3-40);N.forEach((h,s)=>{var x;const l=new P;l.role="n3",l.usuarioId=this.idOf(h),l.parentId=null!==(x=null==h?void 0:h.parentId)&&void 0!==x?x:0,l.nombre=this.nameOf(h),l.contacto=this.contactOf(h),l.w=this.measureW(l.nombre,l.contacto),l.h=60,l.x=Math.round(u-l.w/2),l.y=M+s*(l.h+18),l.rutaDesdePadre=`M ${u} ${g.y+g.h} L ${u} ${l.y}`,this.n3Nodes.push(l)})});const C=[(null!==(j=null===(E=this.rootNode)||void 0===E?void 0:E.y)&&void 0!==j?j:0)+(null!==(R=null===(k=this.rootNode)||void 0===k?void 0:k.h)&&void 0!==R?R:0),...this.n2Nodes.map(g=>g.y+g.h),...this.n3Nodes.map(g=>g.y+g.h)],K=C.length?Math.max(...C):0;this.miniHeight=Math.max(K+120,520)}})}goHome(){this.load(0)}goUp(){var i;null!==(i=this.rootNode)&&void 0!==i&&i.parentId&&this.load(this.rootNode.parentId)}onN2Click(i){this.load(i.usuarioId)}}return(e=r).\u0275fac=function(i){return new(i||e)(t.rXU(I.o))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-embajadores-diagrama"]],viewQuery:function(i,n){if(1&i&&t.GBs(F,7),2&i){let c;t.mGM(c=t.lsd())&&(n.svgRef=c.first)}},standalone:!1,decls:33,vars:13,consts:[["svgRef",""],[1,"pagesHeader"],["slot","start"],["name","flag","color","white"],[1,"org-svg"],["id","shadow","x","-20%","y","-20%","width","140%","height","140%"],["dx","0","dy","2","stdDeviation","2","flood-color","#000","flood-opacity","0.25"],["id","gradRoot","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","#10b981"],["offset","100%","stop-color","#34d399"],["id","gradN2","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","#16a34a"],["offset","100%","stop-color","#22c55e"],["id","gradN3","x1","0","y1","0","x2","0","y2","1"],["offset","0%","stop-color","#2563eb"],["offset","100%","stop-color","#60a5fa"],["class","mini-group",3,"click",4,"ngIf"],["class","link",4,"ngIf"],[4,"ngFor","ngForOf"],["class","mini-group",4,"ngIf"],["class","mini-group",3,"click",4,"ngFor","ngForOf"],["class","mini-group",4,"ngFor","ngForOf"],[1,"mini-group",3,"click"],["width","30","height","30","fill","url(#gradN2)","rx","4","ry","4","filter","url(#shadow)"],["font-size","16","fill","#fff","text-anchor","middle"],[1,"link"],[1,"mini-group"],["filter","url(#shadow)","fill","url(#gradRoot)","rx","8","ry","8",1,"mini-rect"],["fill","#fff","font-size","18",1,"contenido"],["fill","#fff","font-size","12",1,"contenido2"],["filter","url(#shadow)","fill","url(#gradN2)","rx","8","ry","8",1,"mini-rect"],["fill","#fff","font-size","16",1,"contenido"],["filter","url(#shadow)","fill","url(#gradN3)","rx","8","ry","8",1,"mini-rect"]],template:function(i,n){1&i&&(t.j41(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-buttons",2),t.nrm(3,"ion-menu-button"),t.k0s(),t.j41(4,"ion-title")(5,"h1"),t.nrm(6,"ion-icon",3),t.EFF(7," Embajadores"),t.k0s()()()(),t.j41(8,"ion-content"),t.qSk(),t.j41(9,"svg",4,0)(11,"defs")(12,"filter",5),t.nrm(13,"feDropShadow",6),t.k0s(),t.j41(14,"linearGradient",7),t.nrm(15,"stop",8)(16,"stop",9),t.k0s(),t.j41(17,"linearGradient",10),t.nrm(18,"stop",11)(19,"stop",12),t.k0s(),t.j41(20,"linearGradient",13),t.nrm(21,"stop",14)(22,"stop",15),t.k0s()(),t.j41(23,"g"),t.DNE(24,B,4,4,"g",16)(25,G,4,4,"g",16)(26,X,1,1,"path",17)(27,Y,1,1,"path",17)(28,Q,2,1,"ng-container",18)(29,W,2,1,"ng-container",18)(30,S,6,10,"g",19)(31,V,6,10,"g",20)(32,q,6,10,"g",21),t.k0s()()()),2&i&&(t.R7$(9),t.BMQ("width",n.miniWidth)("height",n.miniHeight)("viewBox","0 0 "+n.miniWidth+" "+n.miniHeight),t.R7$(14),t.BMQ("transform",n.transform),t.R7$(),t.Y8G("ngIf",0!==(null==n.rootNode?null:n.rootNode.usuarioId)),t.R7$(),t.Y8G("ngIf",((null==n.rootNode?null:n.rootNode.parentId)||0)>0),t.R7$(),t.Y8G("ngIf",n.busVerticalPath),t.R7$(),t.Y8G("ngIf",n.busHorizontalPath),t.R7$(),t.Y8G("ngForOf",n.n2Nodes),t.R7$(),t.Y8G("ngForOf",n.n3Nodes),t.R7$(),t.Y8G("ngIf",n.rootNode),t.R7$(),t.Y8G("ngForOf",n.n2Nodes),t.R7$(),t.Y8G("ngForOf",n.n3Nodes))},dependencies:[y.Sq,y.bT,m.QW,m.W9,m.eU,m.iq,m.MC,m.BC,m.ai],styles:['@charset "UTF-8";.org-svg[_ngcontent-%COMP%]{width:100%;height:calc(100vh - 112px);display:block}.pagesHeader[_ngcontent-%COMP%]{--background: var(--ion-color-dark)}[_ngcontent-%COMP%]:root{--green-top: #16a34a;--green-bot: #22c55e}.customGreenButton[_ngcontent-%COMP%]{--background: linear-gradient(180deg, var(--green-top), var(--green-bot));--background-hover: linear-gradient(180deg, #15803d, var(--green-top));--background-activated: linear-gradient(180deg, #15803d, var(--green-top));--box-shadow: 0 4px 10px rgba(0,0,0,.18);color:#fff;border-radius:12px;font-weight:600}.referidosHeader[_ngcontent-%COMP%]{background:linear-gradient(180deg,var(--green-top),var(--green-bot));color:#fff}.referidosHeader[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .referidosHeader[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%], .referidosHeader[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .referidosHeader[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff!important}.inputBusqueda[_ngcontent-%COMP%]{--border-color: rgba(34, 197, 94, .35);--highlight-color-focused: var(--green-bot);--highlight-color-valid: var(--green-bot);border-radius:12px}.link[_ngcontent-%COMP%]{stroke:#090909;stroke-width:2;fill:none}','@charset "UTF-8";[_ngcontent-%COMP%]:root{--line: #94a3b8}.contenido[_ngcontent-%COMP%]{opacity:.6;pointer-events:none;transition:opacity .15s ease}.contenido2[_ngcontent-%COMP%]{opacity:0;pointer-events:none;transition:opacity .15s ease}.mini-group[_ngcontent-%COMP%]:hover   .contenido[_ngcontent-%COMP%], .mini-group[_ngcontent-%COMP%]:hover   .contenido2[_ngcontent-%COMP%]{opacity:1}.mini-rect[_ngcontent-%COMP%]{transition:transform .15s ease,filter .15s ease}.mini-group[_ngcontent-%COMP%]:hover   .mini-rect[_ngcontent-%COMP%]{transform:translateY(-2px);filter:brightness(.98)}.org-svg[_ngcontent-%COMP%]{display:block;width:100%;height:auto}']}),r})()}];let z=(()=>{var e;class r{}return(e=r).\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.$C({type:e}),e.\u0275inj=t.G2t({imports:[w.iI.forChild(L),w.iI]}),r})(),U=(()=>{var e;class r{}return(e=r).\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.$C({type:e}),e.\u0275inj=t.G2t({imports:[y.MD,m.bv,z]}),r})()}}]);