"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7273],{7273:(O,_,c)=>{c.r(_),c.d(_,{CelulasPageModule:()=>S});var g=c(2881),M=c(9417),h=c(3092),x=c(9870),e=c(1360),b=c(7248);const P=["svgRef"];function R(n,i){if(1&n&&(e.qSk(),e.nrm(0,"path",13)),2&n){const s=e.XpG().$implicit;e.BMQ("d",s.ruta)}}function $(n,i){if(1&n&&(e.qSk(),e.nrm(0,"line",14)),2&n){const s=e.XpG().$implicit;e.BMQ("x1",s.x-90)("y1",s.y+30)("x2",s.x)("y2",s.y+30)}}function N(n,i){if(1&n&&(e.qSk(),e.j41(0,"text",18),e.EFF(1),e.k0s()),2&n){const s=i.$implicit,o=i.index,t=e.XpG(2).$implicit,a=e.XpG();e.BMQ("x",t.x+a.nodeTextLeftPadding+160)("y",t.y+25*(1+o)+70),e.R7$(),e.JRh(s)}}function k(n,i){if(1&n&&(e.qSk(),e.qex(0),e.j41(1,"g",15),e.nrm(2,"rect",16),e.DNE(3,N,2,3,"text",17),e.k0s(),e.bVm()),2&n){const s=e.XpG().$implicit;e.R7$(2),e.BMQ("x",s.x+160)("y",s.y+70),e.R7$(),e.Y8G("ngForOf",s.children)}}function B(n,i){if(1&n){const s=e.RV6();e.qSk(),e.j41(0,"g",5),e.bIt("click",function(){const t=e.eBV(s).$implicit,a=e.XpG();return e.Njj(a.onRectClick(t.usuarioId))}),e.nrm(1,"rect",6),e.j41(2,"text",7),e.EFF(3),e.k0s(),e.j41(4,"text",8),e.EFF(5),e.k0s(),e.DNE(6,R,1,1,"path",10)(7,$,1,4,"line",11)(8,k,4,3,"ng-container",12),e.k0s()}if(2&n){const s=i.$implicit,o=e.XpG();e.R7$(),e.BMQ("x",s.x)("y",s.y),e.R7$(),e.BMQ("x",s.x+o.nodeTextLeftPadding)("y",s.y+25),e.R7$(),e.JRh(s.nombre),e.R7$(),e.BMQ("x",s.x+o.nodeTextLeftPadding)("y",s.y+40),e.R7$(),e.JRh(s.contacto),e.R7$(),e.Y8G("ngIf",s.parent&&0==s.nivel),e.R7$(),e.Y8G("ngIf",s.parent&&1==s.nivel),e.R7$(),e.Y8G("ngIf",s.nivel>0)}}let F=(()=>{var n;class i{constructor(o){this.usuarioSerivice=o,this.scale=1,this.panX=0,this.panY=0,this.transform="translate(0,0) scale(1)",this.isPanning=!1,this.startX=0,this.startY=0,this.precalculatedNodes=[],this.precalculatedNodesReversed=[],this.xBase=100,this.yBase=40,this.nodeTextLeftPadding=16,this.xSemiStep=20,this.ySemiStep=20,this.xStep=260,this.yStep=100,this.onMouseDown=t=>{this.isPanning=!0,this.startX=t.clientX,this.startY=t.clientY},this.onMouseMove=t=>{this.isPanning&&(this.panX+=t.clientX-this.startX,this.panY+=t.clientY-this.startY,this.startX=t.clientX,this.startY=t.clientY,this.updateTransform())},this.onMouseUp=()=>{this.isPanning=!1},this.onWheel=t=>{t.preventDefault(),this.scale*=1+.1*(t.deltaY<0?1:-1),this.updateTransform()},this.baseNode=new p,this.baseNode.nombre="Embassy",this.baseNode.contacto="",this.baseNode.x=this.xBase,this.baseNode.y=this.yBase}loadDataCelula(o){this.precalculatedNodes=[],this.panX=0,this.panY=0,this.usuarioSerivice.getCelulaFromHere(o).subscribe({next:t=>{var a;console.log(t),this.baseNode=t.nivel1,this.baseNode.x=this.xBase,this.baseNode.y=this.yBase;let u=1;null===(a=t.nivel2)||void 0===a||a.forEach(f=>{var v;let r=new p;r.usuarioId=f.usuarioId,r.nombre=f.nombre,r.contacto=f.contacto,r.x=this.xBase+this.xSemiStep,r.y=this.yBase+this.yStep*u,r.parent=this.baseNode;let C=1;null===(v=t.nivel3)||void 0===v||v.forEach(d=>{if(d.parentId==r.usuarioId){var m;let l=new p;l.usuarioId=d.usuarioId,l.parent=r,l.nombre=d.nombre,l.contacto=d.contacto,l.x=this.xBase+this.xStep*C,l.y=l.parent.y+this.ySemiStep,l.nivel=1;let E=1;l.children=[],null===(m=t.nivel4)||void 0===m||m.forEach(y=>{y.parentId==l.usuarioId&&(l.children.push(y.nombre),E++)}),C++,this.precalculatedNodes.push(l)}}),this.precalculatedNodes.push(r),u++}),this.precalculatedNodesReversed=this.precalculatedNodes.slice().reverse()}})}ngOnInit(){const o=this.svgRef.nativeElement;this.loadDataCelula(0),o.addEventListener("mousedown",this.onMouseDown),o.addEventListener("mousemove",this.onMouseMove),o.addEventListener("mouseup",this.onMouseUp),o.addEventListener("mouseleave",this.onMouseUp),o.addEventListener("wheel",this.onWheel,{passive:!1})}onRectClick(o){this.loadDataCelula(o)}updateTransform(){this.transform=`translate(${this.panX}, ${this.panY}) scale(${this.scale})`}}return(n=i).\u0275fac=function(o){return new(o||n)(e.rXU(b.o))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-celulas"]],viewQuery:function(o,t){if(1&o&&e.GBs(P,7),2&o){let a;e.mGM(a=e.lsd())&&(t.svgRef=a.first)}},standalone:!1,decls:19,vars:10,consts:[["svgRef",""],[1,"pagesHeader"],["slot","start"],["name","grid","color","white"],[1,"org-svg"],[1,"hover-group",3,"click"],["width","180","height","60","fill","#4CAF50","rx","4","ry","4",1,"zoomable"],["font-size","18","text-anchor","start","fill","white",1,"contenido"],["font-size","12","text-anchor","start","fill","white",1,"contenidoContacto"],["class","hover-group",3,"click",4,"ngFor","ngForOf"],["stroke-width","2","stroke","#444","fill","none",4,"ngIf"],["stroke","#444","stroke-width","2",4,"ngIf"],[4,"ngIf"],["stroke-width","2","stroke","#444","fill","none"],["stroke","#444","stroke-width","2"],[1,"hover-subgroup"],["width","20","height","20","fill","#4CAF50","rx","4","ry","4",1,"expandible"],["font-size","14","text-anchor","start","fill","white","class","subcontenido",4,"ngFor","ngForOf"],["font-size","14","text-anchor","start","fill","white",1,"subcontenido"]],template:function(o,t){if(1&o){const a=e.RV6();e.j41(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-buttons",2),e.nrm(3,"ion-menu-button"),e.k0s(),e.j41(4,"ion-title")(5,"h1"),e.nrm(6,"ion-icon",3),e.EFF(7," C\xe9lulas"),e.k0s()()()(),e.j41(8,"ion-content"),e.qSk(),e.j41(9,"svg",4,0)(11,"g")(12,"g",5),e.bIt("click",function(){return e.eBV(a),e.Njj(t.onRectClick(0))}),e.nrm(13,"rect",6),e.j41(14,"text",7),e.EFF(15),e.k0s(),e.j41(16,"text",8),e.EFF(17),e.k0s()(),e.DNE(18,B,9,11,"g",9),e.k0s()()()}2&o&&(e.R7$(11),e.BMQ("transform",t.transform),e.R7$(2),e.BMQ("x",t.baseNode.x)("y",t.baseNode.y),e.R7$(),e.BMQ("x",t.baseNode.x+t.nodeTextLeftPadding)("y",t.baseNode.y+25),e.R7$(),e.JRh(t.baseNode.nombre),e.R7$(),e.BMQ("x",t.baseNode.x+t.nodeTextLeftPadding)("y",t.baseNode.y+40),e.R7$(),e.JRh(t.baseNode.contacto),e.R7$(),e.Y8G("ngForOf",t.precalculatedNodesReversed))},dependencies:[g.Sq,g.bT,h.QW,h.W9,h.eU,h.iq,h.MC,h.BC,h.ai],styles:[".org-svg[_ngcontent-%COMP%]{width:100vw;height:100vh;background:#f0f0f0;cursor:grab;-webkit-user-select:none;user-select:none}",".contenido[_ngcontent-%COMP%]{opacity:.5;transition:opacity .3s ease;pointer-events:none}.contenidoContacto[_ngcontent-%COMP%], .subcontenido[_ngcontent-%COMP%]{opacity:0;transition:opacity .3s ease;pointer-events:none}.hover-group[_ngcontent-%COMP%]:hover   .contenido[_ngcontent-%COMP%], .hover-group[_ngcontent-%COMP%]:hover   .contenidoContacto[_ngcontent-%COMP%], .hover-subgroup[_ngcontent-%COMP%]:hover   .subcontenido[_ngcontent-%COMP%]{opacity:1}.zoomable[_ngcontent-%COMP%]{transition:all .3s ease}.hover-group[_ngcontent-%COMP%]:hover   .zoomable[_ngcontent-%COMP%]{width:240px;cursor:pointer!important;fill:#023f3c}.expandible[_ngcontent-%COMP%]{transition:all .3s ease}.expandible[_ngcontent-%COMP%]:hover{width:240px;height:240px;fill:#023f3c;cursor:pointer!important}"]}),i})();class p{constructor(){this.usuarioId=0,this.parentId=0,this.nombre="",this.contacto="",this.nivel=0,this.x=0,this.y=0}get ruta(){return`M ${this.parent.x+10} ${this.parent.y+60} C ${this.parent.x+10} ${this.y+30}, ${this.parent.x+10} ${this.y+30}, ${this.x} ${this.y+30}`}}const w=[{path:"",component:F}];let I=(()=>{var n;class i{}return(n=i).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[x.iI.forChild(w),x.iI]}),i})(),S=(()=>{var n;class i{}return(n=i).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[g.MD,M.YN,h.bv,I]}),i})()}}]);