"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3076],{3076:(Pe,M,l)=>{l.r(M),l.d(M,{PeriodosPageModule:()=>Fe});var g=l(2881),c=l(9417),s=l(3092),v=l(9870),D=l(467),k=l(7550),F=l(2042),d=l(3662),b=l(1413),R=l(152),S=l(3294),A=l(6977),$=l(7786),G=l(9172),y=l(5558),T=l(9437),x=l(7673),B=l(6354),Y=l(3),f=l(3069),E=l(6704),P=l(3746),N=l(980),_=l(7356),e=l(1360),p=l(3191);let V=(()=>{var t;class n extends Y.xW{format(o,a){if("input"===a){const r=o.getMonth()+1,m=o.getFullYear();return`${r.toString().padStart(2,"0")}/${m}`}return super.format(o,a)}}return(t=n).\u0275fac=(()=>{let i;return function(a){return(i||(i=e.xGo(t)))(a||t)}})(),t.\u0275prov=e.jDH({token:t,factory:t.\u0275fac}),n})();const X={parse:{dateInput:"MM/YYYY"},display:{dateInput:"input",monthYearLabel:"MMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}};let w=(()=>{var t;class n{constructor(){this.label="Mes/A\xf1o"}setMonthAndYear(o,a){const r=new Date(o.getFullYear(),o.getMonth(),1);this.control.setValue(r),a.close()}onChange(){this.control.setValue(this.control.value)}}return(t=n).\u0275fac=function(o){return new(o||t)},t.\u0275cmp=e.VBU({type:t,selectors:[["app-mes-anio-picker"]],inputs:{control:"control",label:"label"},features:[e.Jv_([{provide:_.D,useClass:V},{provide:_.a,useValue:X}])],decls:9,vars:4,consts:[["picker",""],["appearance","fill",1,"custom-datepicker"],["matInput","",3,"dateChange","matDatepicker","formControl"],["matIconSuffix","",3,"for"],["touchUi","","startView","multi-year","panelClass","month-year-picker",3,"monthSelected"]],template:function(o,a){if(1&o){const r=e.RV6();e.j41(0,"mat-form-field",1)(1,"mat-label"),e.EFF(2),e.k0s(),e.j41(3,"input",2),e.bIt("dateChange",function(){return e.eBV(r),e.Njj(a.onChange())}),e.k0s(),e.j41(4,"mat-hint"),e.EFF(5,"MM/YYYY"),e.k0s(),e.nrm(6,"mat-datepicker-toggle",3),e.j41(7,"mat-datepicker",4,0),e.bIt("monthSelected",function(u){e.eBV(r);const h=e.sdS(8);return e.Njj(a.setMonthAndYear(u,h))}),e.k0s()()}if(2&o){const r=e.sdS(8);e.R7$(2),e.JRh(a.label),e.R7$(),e.Y8G("matDatepicker",r)("formControl",a.control),e.R7$(3),e.Y8G("for",r)}},dependencies:[g.MD,c.X1,c.me,c.BC,c.l_,E.M,p.j,p.M,p.c,p.g,P.fS,P.fg,f.X6,f.Vh,f.bZ,f.bU],encapsulation:2}),n})();var j=l(6862);const U=["class","periodo form"];function O(t,n){1&t&&(e.j41(0,"ion-text",13),e.EFF(1," Campo requerido "),e.k0s())}function z(t,n){if(1&t&&(e.j41(0,"mat-form-field",14)(1,"mat-label"),e.EFF(2,"Fecha de incio"),e.k0s(),e.nrm(3,"input",15),e.j41(4,"mat-hint"),e.EFF(5,"DD/MM/YYYY"),e.k0s(),e.nrm(6,"mat-datepicker-toggle",16)(7,"mat-datepicker",17,0),e.k0s()),2&t){const i=e.sdS(8),o=e.XpG();e.R7$(3),e.Y8G("min",o.minDate)("max",o.maxDate)("matDatepicker",i),e.R7$(3),e.Y8G("for",i)}}function W(t,n){1&t&&(e.j41(0,"ion-text",13),e.EFF(1," Campo requerido "),e.k0s())}function H(t,n){if(1&t&&(e.j41(0,"mat-form-field",14)(1,"mat-label"),e.EFF(2,"Fecha final"),e.k0s(),e.nrm(3,"input",18),e.j41(4,"mat-hint"),e.EFF(5,"DD/MM/YYYY"),e.k0s(),e.nrm(6,"mat-datepicker-toggle",16)(7,"mat-datepicker",17,0),e.k0s()),2&t){const i=e.sdS(8),o=e.XpG();e.R7$(3),e.Y8G("min",o.minDate)("max",o.maxDate)("matDatepicker",i),e.R7$(3),e.Y8G("for",i)}}function J(t,n){1&t&&(e.j41(0,"ion-text",13),e.EFF(1," Campo requerido "),e.k0s())}function L(t,n){if(1&t&&(e.j41(0,"mat-form-field",14)(1,"mat-label"),e.EFF(2,"Fecha pago de empresa"),e.k0s(),e.nrm(3,"input",19),e.j41(4,"mat-hint"),e.EFF(5,"DD/MM/YYYY"),e.k0s(),e.nrm(6,"mat-datepicker-toggle",16)(7,"mat-datepicker",17,0),e.k0s()),2&t){const i=e.sdS(8),o=e.XpG();e.R7$(3),e.Y8G("min",o.maxDate)("matDatepicker",i),e.R7$(3),e.Y8G("for",i)}}function Q(t,n){1&t&&(e.j41(0,"ion-text",13),e.EFF(1," Campo requerido "),e.k0s())}function Z(t,n){if(1&t&&(e.j41(0,"mat-form-field",14)(1,"mat-label"),e.EFF(2,"Fecha pago de embajador"),e.k0s(),e.nrm(3,"input",20),e.j41(4,"mat-hint"),e.EFF(5,"DD/MM/YYYY"),e.k0s(),e.nrm(6,"mat-datepicker-toggle",16)(7,"mat-datepicker",17,0),e.k0s()),2&t){const i=e.sdS(8),o=e.XpG();e.R7$(3),e.Y8G("min",o.maxDate)("matDatepicker",i),e.R7$(3),e.Y8G("for",i)}}function K(t,n){1&t&&(e.j41(0,"ion-text",13),e.EFF(1," Campo requerido "),e.k0s())}let I=(()=>{var t;class n{constructor(o,a,r,m){this.fb=o,this.periodoService=a,this.toastController=r,this.modalCtrl=m,this.btnName="AGREGAR",this.title="AGREGAR",this.id=void 0,this.formEnviado=!1,this.mesAnioSelected=!1,this.formulario=this.fb.group({mesAnio:["",c.k0.required],fechaInicio:["",c.k0.required],fechaFin:["",c.k0.required],fechaPagoEmpresas:["",c.k0.required],fechaPagoEmbajadores:["",c.k0.required]})}ngOnInit(){var o;null!=this.id&&(this.btnName="GUARDAR",this.title="MODIFICAR",this.periodoService.getByID(this.id).subscribe({next:a=>{this.formulario.patchValue({mesAnio:new Date(a.data.anio,a.data.mes-1,1),fechaInicio:a.data.fechaInicio,fechaFin:a.data.fechaInicio,fechaPagoEmpresas:a.data.fechaPagoEmpresas,fechaPagoEmbajadores:a.data.fechaPagoEmbajadores})}})),null===(o=this.formulario.get("mesAnio"))||void 0===o||o.valueChanges.subscribe(a=>{if(a instanceof Date){this.mesAnioSelected=!0;const r=a.getFullYear(),m=a.getMonth();this.minDate=new Date(r,m,1),this.maxDate=new Date(r,m+1,0)}})}enviarFormulario(){if(this.formEnviado)return;if(this.formEnviado=!0,this.formulario.invalid)return this.formulario.markAllAsTouched(),void(this.formEnviado=!1);const o=this.formulario.value.mesAnio,a=o.getMonth()+1;var m={anio:o.getFullYear(),mes:a,fechaInicio:this.formulario.controls.fechaInicio.value,fechaFin:this.formulario.controls.fechaFin.value,fechaPagoEmbajadores:this.formulario.controls.fechaPagoEmbajadores.value,fechaPagoEmpresas:this.formulario.controls.fechaPagoEmpresas.value};null!=this.id&&(m.id=this.id),this.periodoService.save(m).pipe((0,N.j)(()=>{this.formEnviado=!1})).subscribe({next:u=>{u&&(this.toastController.create({message:"periodo guardado.",duration:3e3,color:"success",position:"top"}).then(h=>h.present()),this.modalCtrl.dismiss(!0))}})}getControl(o){return this.formulario.get(o)}close(){this.modalCtrl.dismiss()}get mesAnioControl(){return this.formulario.get("mesAnio")}}return(t=n).\u0275fac=function(o){return new(o||t)(e.rXU(c.ok),e.rXU(j.Y),e.rXU(s.K_),e.rXU(s.W3))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-modal",8,"periodo","form"]],inputs:{id:"id"},features:[e.Jv_([(0,Y.aw)()])],attrs:U,decls:23,vars:15,consts:[["picker",""],[1,"modalHeader"],["slot","end"],[3,"click"],["name","close"],[1,"ion-padding",3,"fullscreen"],[1,"modalform",3,"formGroup"],[1,"modalform-title","ion-text-center"],["label","Periodo (Mes/A\xf1o)",3,"control"],["color","danger",4,"ngIf"],["appearance","fill","class","custom-datepicker",4,"ngIf"],[2,"width","100%","text-align","center"],[1,"customButton",3,"click","disabled"],["color","danger"],["appearance","fill",1,"custom-datepicker"],["matInput","","formControlName","fechaInicio",3,"min","max","matDatepicker"],["matIconSuffix","",3,"for"],["touchUi",""],["matInput","","formControlName","fechaFin",3,"min","max","matDatepicker"],["matInput","","formControlName","fechaPagoEmpresas",3,"min","matDatepicker"],["matInput","","formControlName","fechaPagoEmbajadores",3,"min","matDatepicker"]],template:function(o,a){if(1&o&&(e.j41(0,"ion-header",1)(1,"ion-buttons",2)(2,"ion-button",3),e.bIt("click",function(){return a.close()}),e.nrm(3,"ion-icon",4),e.k0s()()(),e.j41(4,"ion-content",5)(5,"form",6)(6,"h2",7),e.EFF(7),e.k0s(),e.nrm(8,"app-mes-anio-picker",8),e.DNE(9,O,2,0,"ion-text",9)(10,z,9,4,"mat-form-field",10)(11,W,2,0,"ion-text",9)(12,H,9,4,"mat-form-field",10)(13,J,2,0,"ion-text",9)(14,L,9,3,"mat-form-field",10)(15,Q,2,0,"ion-text",9)(16,Z,9,3,"mat-form-field",10)(17,K,2,0,"ion-text",9),e.k0s()(),e.j41(18,"ion-footer")(19,"ion-toolbar")(20,"div",11)(21,"ion-button",12),e.bIt("click",function(){return a.enviarFormulario()}),e.EFF(22),e.k0s()()()()),2&o){let r,m,u,h,C;e.R7$(4),e.Y8G("fullscreen",!1),e.R7$(),e.Y8G("formGroup",a.formulario),e.R7$(2),e.SpI("",a.title," PERIODO"),e.R7$(),e.Y8G("control",a.mesAnioControl),e.R7$(),e.Y8G("ngIf",(null==(r=a.getControl("mesAnio"))?null:r.invalid)&&(null==(r=a.getControl("mesAnio"))?null:r.touched)),e.R7$(),e.Y8G("ngIf",a.mesAnioSelected),e.R7$(),e.Y8G("ngIf",(null==(m=a.getControl("fechaInicio"))?null:m.invalid)&&(null==(m=a.getControl("fechaInicio"))?null:m.touched)&&a.mesAnioSelected),e.R7$(),e.Y8G("ngIf",a.mesAnioSelected),e.R7$(),e.Y8G("ngIf",(null==(u=a.getControl("fechaFin"))?null:u.invalid)&&(null==(u=a.getControl("fechaFin"))?null:u.touched)&&a.mesAnioSelected),e.R7$(),e.Y8G("ngIf",a.mesAnioSelected),e.R7$(),e.Y8G("ngIf",(null==(h=a.getControl("fechaPagoEmpresas"))?null:h.invalid)&&(null==(h=a.getControl("fechaPagoEmpresas"))?null:h.touched)&&a.mesAnioSelected),e.R7$(),e.Y8G("ngIf",a.mesAnioSelected),e.R7$(),e.Y8G("ngIf",(null==(C=a.getControl("fechaPagoEmbajadores"))?null:C.invalid)&&(null==(C=a.getControl("fechaPagoEmbajadores"))?null:C.touched)&&a.mesAnioSelected),e.R7$(4),e.Y8G("disabled",a.formEnviado),e.R7$(),e.SpI(" ",a.btnName," ")}},dependencies:[s.bv,s.Jm,s.QW,s.W9,s.M0,s.eU,s.iq,s.IO,s.ai,c.X1,c.qT,c.me,c.BC,c.cb,c.j4,c.JD,g.MD,g.bT,E.M,p.j,p.M,p.c,p.g,P.fS,P.fg,f.X6,f.Vh,f.bZ,f.bU,w],encapsulation:2,changeDetection:0}),n})();const q=()=>[20,50,100];function ee(t,n){1&t&&(e.j41(0,"th",27),e.EFF(1," A\xf1o "),e.k0s())}function te(t,n){if(1&t&&(e.j41(0,"td",28),e.EFF(1),e.k0s()),2&t){const i=n.$implicit;e.R7$(),e.SpI(" ",i.anio," ")}}function oe(t,n){1&t&&(e.j41(0,"th",27),e.EFF(1," Mes "),e.k0s())}function ae(t,n){if(1&t&&(e.j41(0,"td",28),e.EFF(1),e.k0s()),2&t){const i=n.$implicit,o=e.XpG();e.R7$(),e.SpI(" ",o.nombreMes(i.mes)," ")}}function ne(t,n){1&t&&(e.j41(0,"th",27),e.EFF(1," Fecha de inicio "),e.k0s())}function ie(t,n){if(1&t&&(e.j41(0,"td",28),e.EFF(1),e.k0s()),2&t){const i=n.$implicit,o=e.XpG();e.R7$(),e.SpI(" ",o.formatFecha(i.fechaInicio)," ")}}function re(t,n){1&t&&(e.j41(0,"th",27),e.EFF(1," Fecha Fin "),e.k0s())}function se(t,n){if(1&t&&(e.j41(0,"td",28),e.EFF(1),e.k0s()),2&t){const i=n.$implicit,o=e.XpG();e.R7$(),e.SpI(" ",o.formatFecha(i.fechaFin)," ")}}function le(t,n){1&t&&(e.j41(0,"th",27),e.EFF(1," Fecha pago de empresa "),e.k0s())}function me(t,n){if(1&t&&(e.j41(0,"td",28),e.EFF(1),e.k0s()),2&t){const i=n.$implicit,o=e.XpG();e.R7$(),e.SpI(" ",o.formatFecha(i.fechaPagoEmpresas)," ")}}function ce(t,n){1&t&&(e.j41(0,"th",27),e.EFF(1," Fecha pago de embajador "),e.k0s())}function de(t,n){if(1&t&&(e.j41(0,"td",28),e.EFF(1),e.k0s()),2&t){const i=n.$implicit,o=e.XpG();e.R7$(),e.SpI(" ",o.formatFecha(i.fechaPagoEmbajadores)," ")}}function ue(t,n){1&t&&e.nrm(0,"tr",29)}function fe(t,n){if(1&t){const i=e.RV6();e.j41(0,"tr",30),e.bIt("click",function(){const a=e.eBV(i).$implicit,r=e.XpG();return e.Njj(r.editModal(a.id))}),e.k0s()}}function pe(t,n){if(1&t&&(e.j41(0,"tr",31)(1,"td",32),e.EFF(2," No se encontraron registros disponibles. "),e.k0s()()),2&t){const i=e.XpG();e.R7$(),e.BMQ("colspan",i.displayedColumns.length)}}const he=[{path:"",component:(()=>{var t;class n{constructor(o,a){this.periodoService=o,this.modalCtrl=a,this.dataSourceTable=new d.I6,this.displayedColumns=["Anio","Mes","FechaInicio","FechaFin","FechaPagoEmpresas","FechaPagoEmbajadores"],this.inputBuscar=new b.B,this.query="",this.showNoData=!1,this.destroy$=new b.B}ngAfterViewInit(){this.dataSourceTable.paginator=this.paginator,this.loadtable()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngOnInit(){this.inputBuscar.pipe((0,R.B)(1e3),(0,S.F)(),(0,A.Q)(this.destroy$)).subscribe(o=>{this.query=o.toString(),this.loadtable()})}loadtable(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),(0,$.h)(this.sort.sortChange,this.paginator.page).pipe((0,G.Z)({}),(0,y.n)(()=>this.periodoService.getTablePaginated({page:this.paginator.pageIndex,size:this.paginator.pageSize,sortBy:this.sort.active,sortDir:this.sort.direction,searchQuery:this.query}).pipe((0,T.W)(()=>(0,x.of)(null)))),(0,B.T)(o=>null===o?[]:(this.total=o.data.total,o.data.items))).subscribe(o=>{this.dataSourceTable=new d.I6(o||[]),this.showNoData=0===(o||[]).length})}addModal(){var o=this;return(0,D.A)(function*(){const a=yield o.modalCtrl.create({component:I,cssClass:"modal-periodo"});yield a.present();const{data:r}=yield a.onDidDismiss();r&&(console.log(r),o.loadtable())})()}editModal(o){var a=this;return(0,D.A)(function*(){const r=yield a.modalCtrl.create({component:I,cssClass:"modal-periodo",componentProps:{id:o}});yield r.present();const{data:m}=yield r.onDidDismiss();m&&(console.log(m),a.loadtable())})()}nombreMes(o){return["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][o-1]||""}formatFecha(o){if(null==o)return"No aplica";const a=new Date(o),r=a.getDate().toString().padStart(2,"0");let m=a.toLocaleString("es-MX",{month:"long"});return m=m.charAt(0).toUpperCase()+m.slice(1),`${r} ${m} ${a.getFullYear()}`}}return(t=n).\u0275fac=function(o){return new(o||t)(e.rXU(j.Y),e.rXU(s.W3))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-periodos"]],viewQuery:function(o,a){if(1&o&&(e.GBs(k.iy,5),e.GBs(F.B4,5)),2&o){let r;e.mGM(r=e.lsd())&&(a.paginator=r.first),e.mGM(r=e.lsd())&&(a.sort=r.first)}},standalone:!1,decls:48,vars:8,consts:[[1,"pagesHeader"],["slot","start"],["name","calendar","color","white"],[1,"pagesContent"],[1,"ion-align-items-center"],["size","12","size-md","9",1,"ion-text-center"],["placeholder","Buscar por nombre de mes o a\xf1o",1,"inputBusqueda",3,"ionInput"],["slot","end","name","search","aria-hidden","true"],["size","12","size-md","2",1,"ion-text-center"],["expand","block",1,"customGreenButton",3,"click"],["name","add","color","white"],[1,"referidosHeader"],[1,"title"],[2,"overflow-x","auto"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","Anio"],["mat-header-cell","","style","padding-left: 1rem;","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Mes"],["matColumnDef","FechaInicio"],["matColumnDef","FechaFin"],["matColumnDef","FechaPagoEmpresas"],["matColumnDef","FechaPagoEmbajadores"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","mydivoutermulti elemento-renglon row_clickable",3,"click",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"length","pageSizeOptions","pageSize"],["mat-header-cell","","mat-sort-header","",2,"padding-left","1rem"],["mat-cell",""],["mat-header-row",""],["mat-row","",1,"mydivoutermulti","elemento-renglon","row_clickable",3,"click"],[1,"mat-row"],[2,"text-align","center","padding","1rem"]],template:function(o,a){1&o&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e.nrm(3,"ion-menu-button"),e.k0s(),e.j41(4,"ion-title")(5,"h1"),e.nrm(6,"ion-icon",2),e.EFF(7," Corte mensual / Tabla de periodos"),e.k0s()()()(),e.j41(8,"ion-content",3)(9,"div")(10,"ion-grid")(11,"ion-row",4)(12,"ion-col",5)(13,"ion-input",6),e.bIt("ionInput",function(m){return a.inputBuscar.next(m.detail.value||"")}),e.nrm(14,"ion-icon",7),e.k0s()(),e.j41(15,"ion-col",8)(16,"ion-button",9),e.bIt("click",function(){return a.addModal()}),e.nrm(17,"ion-icon",10),e.EFF(18," AGREGAR"),e.k0s()()()()(),e.j41(19,"ion-card")(20,"ion-card-header",11)(21,"ion-card-title",12),e.EFF(22,"Periodos"),e.k0s()(),e.j41(23,"ion-card-content")(24,"div",13)(25,"table",14),e.qex(26,15),e.DNE(27,ee,2,0,"th",16)(28,te,2,1,"td",17),e.bVm(),e.qex(29,18),e.DNE(30,oe,2,0,"th",16)(31,ae,2,1,"td",17),e.bVm(),e.qex(32,19),e.DNE(33,ne,2,0,"th",16)(34,ie,2,1,"td",17),e.bVm(),e.qex(35,20),e.DNE(36,re,2,0,"th",16)(37,se,2,1,"td",17),e.bVm(),e.qex(38,21),e.DNE(39,le,2,0,"th",16)(40,me,2,1,"td",17),e.bVm(),e.qex(41,22),e.DNE(42,ce,2,0,"th",16)(43,de,2,1,"td",17),e.bVm(),e.DNE(44,ue,1,0,"tr",23)(45,fe,1,0,"tr",24)(46,pe,3,1,"tr",25),e.k0s()(),e.nrm(47,"mat-paginator",26),e.k0s()()()),2&o&&(e.R7$(25),e.Y8G("dataSource",a.dataSourceTable),e.R7$(19),e.Y8G("matHeaderRowDef",a.displayedColumns)("matHeaderRowDefSticky",!0),e.R7$(),e.Y8G("matRowDefColumns",a.displayedColumns),e.R7$(2),e.Y8G("length",a.total)("pageSizeOptions",e.lJ4(7,q))("pageSize",50))},dependencies:[s.Jm,s.QW,s.b_,s.I9,s.ME,s.tN,s.hU,s.W9,s.lO,s.eU,s.iq,s.$w,s.MC,s.ln,s.BC,s.ai,s.Gw,d.Zl,d.tL,d.ji,d.cC,d.YV,d.iL,d.KS,d.$R,d.YZ,d.NB,d.ky,k.iy,F.B4,F.aE],encapsulation:2}),n})()}];let ge=(()=>{var t;class n{}return(t=n).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[v.iI.forChild(he),v.iI]}),n})(),Fe=(()=>{var t;class n{}return(t=n).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[g.MD,c.YN,s.bv,ge,d.tP,k.Ou,F.NQ]}),n})()}}]);