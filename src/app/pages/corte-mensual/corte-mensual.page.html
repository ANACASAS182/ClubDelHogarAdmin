<ion-header class="pagesHeader">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>
      <h1><ion-icon name="calendar" color="white"></ion-icon> Corte mensual</h1>
    </ion-title>
  </ion-toolbar>
</ion-header>


<ion-content [fullscreen]="true">
  <ion-grid>
    <ion-row>
      <ion-col size="4">
        <ion-select [(ngModel)]="periodoSeleccionado" label="Periodo" label-placement="stacked">
          <ion-select-option *ngFor="let periodo of periodos" [value]="periodo">{{ periodo.mesLetra }} {{ periodo.anio
            }}</ion-select-option>
        </ion-select>
      </ion-col>
      <ion-col size="4">
        <ion-select [(ngModel)]="tipoCorteMensual" label="Tipo de corte" label-placement="stacked">
          <ion-select-option [value]="1">Embajadores</ion-select-option>
          <ion-select-option [value]="2">Empresas</ion-select-option>
        </ion-select>
      </ion-col>
      <ion-col size="4" style="text-align: end;">
        <ion-button (click)="getCorteMensual()">Calcular</ion-button>

            <ion-button color="success" fill="outline"
                    (click)="exportarExcel()"
                    [disabled]="!corteMensual">
          <ion-icon slot="start" name="download-outline"></ion-icon>
          EXPORTAR A EXCEL
        </ion-button>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col size="4" style="text-align: center;">
        <div style="padding:4px; border-radius: 6px; border: 1px solid #666;">
          <span>Embajadores / Mes</span><br />
          <strong>{{corteMensual?.embajadoresMes}}</strong>
        </div>
      </ion-col>
      <ion-col size="4" style="text-align: center;">
        <div style="padding:4px; border-radius: 6px; border: 1px solid #666;">
          <span>Importe Total Mes</span><br />
          <strong>${{corteMensual?.importeTotal | number:'1.2'}} MXN</strong>
        </div>
      </ion-col>
      <ion-col size="4" style="text-align: center;">
        <div style="padding:4px; border-radius: 6px; border: 1px solid #666;">
          <span>Importe acumulado Embassy</span><br />
          <strong>${{corteMensual?.importeEmbassy | number:'1.2'}} MXN</strong>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>

  <ion-card>
    <ion-item>
      <ion-grid>
        <ion-row>
          <ion-col size="4"><strong>Embajador</strong></ion-col>
          <ion-col size="2" style="text-align: end;"><strong>Referencias<br />Directas</strong></ion-col>
          <ion-col size="2" style="text-align: end;"><strong>Ganancias<br />Directas</strong></ion-col>
          <ion-col size="2" style="text-align: end;"><strong>Referencias<br />Indirectas</strong></ion-col>
          <ion-col size="2" style="text-align: end;"><strong>Ganancias<br />Indirectas</strong></ion-col>
        </ion-row>
      </ion-grid>
    </ion-item>
    <ion-item *ngFor="let embajador of corteMensual?.embajadores!">
      <ion-grid class="row_clickable" (click)="mostrarDetalleEmbajadorMes(embajador.id)">
        <ion-row>
          <ion-col size="4">{{embajador.nombre}}</ion-col>
          <ion-col size="2" style="text-align: end;">{{embajador.referenciasDirectas | number:'1.0'}}</ion-col>
          <ion-col size="2" style="text-align: end;">${{embajador.importeDirecto | number:'1.2'}} MXN</ion-col>
          <ion-col size="2" style="text-align: end;">{{embajador.referenciasIndirectas | number:'1.0'}}</ion-col>
          <ion-col size="2" style="text-align: end;">${{embajador.importeIndirecto | number:'1.2'}} MXN</ion-col>
        </ion-row>
      </ion-grid>
    </ion-item>
  </ion-card>


</ion-content>